<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="cs" lang="cs">
<head>


<script type="text/javascript" src="/static/js/analytics.js"></script>
<script type="text/javascript">archive_analytics.values.server_name="wwwb-app16.us.archive.org";archive_analytics.values.server_ms=398;</script>
<link type="text/css" rel="stylesheet" href="/static/css/banner-styles.css"/>


<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="author" content="Statisticat, LLC." />
<meta name="copyright" content="Statisticat, LLC. - Statistical Consulting and Support" />
<meta name="description" content="The Metropolis-within-Gibbs (MWG) algorithm is the original MCMC algorithm. MWG is a componentwise random-walk Metropolis algorithm that usually does not involve Gibbs sampling." />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Metropolis-within-Gibbs</title>
<link rel="stylesheet" type="text/css" href="/web/20150418131915cs_/http://www.bayesian-inference.com/css/default.css" media="screen" />
<link rel="stylesheet" type="text/css" href="/web/20150418131915cs_/http://www.bayesian-inference.com/css/print.css" media="print" />
<link rel="shortcut icon" href="/web/20150418131915im_/http://www.bayesian-inference.com/favicon.ico" />
<script type="text/javascript">
function bookmarksite(title,url){
if (window.sidebar) // firefox
	window.sidebar.addPanel(title, url, "");
else if(window.opera && window.print){ // opera
	var elem = document.createElement('a');
	elem.setAttribute('href',url);
	elem.setAttribute('title',title);
	elem.setAttribute('rel','sidebar');
	elem.click();
} 
else if(document.all) // ie
	window.external.AddFavorite(url, title);
}
</script>
<script type="text/javascript">
var linktext=new Array()
linktext[0]="<center>Go to Home Page</center>"
linktext[1]="<center>Add to Favorites (Bookmark this Page)</center>"
linktext[2]="<center>Send Email to a Friend</center>"
linktext[3]="<center>Make a Suggestion</center>"
var ns6=document.getElementById&&!document.all
var ie=document.all
function show_text(thetext, whichdiv){
if (ie) eval("document.all."+whichdiv).innerHTML=linktext[thetext]
else if (ns6) document.getElementById(whichdiv).innerHTML=linktext[thetext]
}
function resetit(whichdiv){
if (ie) eval("document.all."+whichdiv).innerHTML=' '
else if (ns6) document.getElementById(whichdiv).innerHTML=' '
}
</script>
<script type="text/javascript">
function mailpage()
{
mail_str = "mailto:?subject=Check out this webpage: " + document.title;
mail_str += "&body=I thought you might be interested in this webpage: " + document.title;
mail_str += ". You can view it here: " + location.href;
location.href = mail_str;
}
</script>
</head>
<body>


<!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript">//<![CDATA[
var __wm = (function(imgWidth,imgHeight,yearImgWidth,monthImgWidth){
var wbPrefix = "/web/";
var wbCurrentUrl = "http://www.bayesian-inference.com/mcmcmwg";

var firstYear = 1996;
var displayDay = "18";
var displayMonth = "Apr";
var displayYear = "2015";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
var $D=document,$=function(n){return document.getElementById(n)};
var trackerVal,curYear = -1,curMonth = -1;
var yearTracker,monthTracker;
function showTrackers(val) {
  if (val===trackerVal) return;
  var $ipp=$("wm-ipp");
  var $y=$("displayYearEl"),$m=$("displayMonthEl"),$d=$("displayDayEl");
  if (val) {
    $ipp.className="hi";
  } else {
    $ipp.className="";
    $y.innerHTML=displayYear;$m.innerHTML=displayMonth;$d.innerHTML=displayDay;
  }
  yearTracker.style.display=val?"inline":"none";
  monthTracker.style.display=val?"inline":"none";
  trackerVal = val;
}
function trackMouseMove(event,element) {
  var eventX = getEventX(event);
  var elementX = getElementX(element);
  var xOff = Math.min(Math.max(0, eventX - elementX),imgWidth);
  var monthOff = xOff % yearImgWidth;

  var year = Math.floor(xOff / yearImgWidth);
  var monthOfYear = Math.min(11,Math.floor(monthOff / monthImgWidth));
  // 1 extra border pixel at the left edge of the year:
  var month = (year * 12) + monthOfYear;
  var day = monthOff % 2==1?15:1;
  var dateString = zeroPad(year + firstYear) + zeroPad(monthOfYear+1,2) +
    zeroPad(day,2) + "000000";

  $("displayYearEl").innerHTML=year+firstYear;
  $("displayMonthEl").innerHTML=prettyMonths[monthOfYear];
  // looks too jarring when it changes..
  //$("displayDayEl").innerHTML=zeroPad(day,2);
  var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
  $("wm-graph-anchor").href=url;

  if(curYear != year) {
    var yrOff = year * yearImgWidth;
    yearTracker.style.left = yrOff + "px";
    curYear = year;
  }
  if(curMonth != month) {
    var mtOff = year + (month * monthImgWidth) + 1;
    monthTracker.style.left = mtOff + "px";
    curMonth = month;
  }
}
function hideToolbar() {
  $("wm-ipp").style.display="none";
}
function bootstrap() {
  var $spk=$("wm-ipp-sparkline");
  yearTracker=$D.createElement('div');
  yearTracker.className='yt';
  with(yearTracker.style){
    display='none';width=yearImgWidth+"px";height=imgHeight+"px";
  }
  monthTracker=$D.createElement('div');
  monthTracker.className='mt';
  with(monthTracker.style){
    display='none';width=monthImgWidth+"px";height=imgHeight+"px";
  }
  $spk.appendChild(yearTracker);
  $spk.appendChild(monthTracker);

  var $ipp=$("wm-ipp");
  $ipp&&disclaimElement($ipp);
}
return{st:showTrackers,mv:trackMouseMove,h:hideToolbar,bt:bootstrap};
})(525, 27, 25, 2);//]]>
</script>
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  min-width:800px !important;
}
</style>
<div id="wm-ipp" lang="en" style="display:none;">

<div style="position:fixed;left:0;top:0;width:100%!important">
<div id="wm-ipp-inside">
   <table style="width:100%;"><tbody><tr>
   <td id="wm-logo">
       <a href="/web/" title="Wayback Machine home page"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0" /></a>
   </td>
   <td class="c">
       <table style="margin:0 auto;"><tbody><tr>
       <td class="u" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://www.bayesian-inference.com/mcmcmwg" style="width:400px;" onfocus="this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20150418131915" /><input type="submit" value="Go" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td class="n" rowspan="2">
           <table><tbody>
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr class="m">
           	<td class="b" nowrap="nowrap">
		
		    <a href="/web/20150311024722/http://www.bayesian-inference.com/mcmcmwg" title="11 Mar 2015">MAR</a>
		
		</td>
		<td class="c" id="displayMonthEl" title="You are here: 13:19:15 Apr 18, 2015">APR</td>
		<td class="f" nowrap="nowrap">
		
		    <a href="/web/20150521232706/http://www.bayesian-inference.com/mcmcmwg" title="21 May 2015"><strong>MAY</strong></a>
		
                </td>
	    </tr>
           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr class="d">
               <td class="b" nowrap="nowrap">
               
                   <a href="/web/20150311024722/http://www.bayesian-inference.com/mcmcmwg" title="2:47:22 Mar 11, 2015"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
               
               </td>
               <td class="c" id="displayDayEl" style="width:34px;font-size:24px;" title="You are here: 13:19:15 Apr 18, 2015">18</td>
	       <td class="f" nowrap="nowrap">
               
		   <a href="/web/20150521232706/http://www.bayesian-inference.com/mcmcmwg" title="23:27:06 May 21, 2015"><img src="/static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0" /></a>
	       
	       </td>
           </tr>
           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr class="y">
	       <td class="b" nowrap="nowrap">
               
                   2014
               
               </td>
               <td class="c" id="displayYearEl" title="You are here: 13:19:15 Apr 18, 2015">2015</td>
	       <td class="f" nowrap="nowrap">
               
                   2016
               
	       </td>
           </tr>
           </tbody></table>
       </td>
       </tr>
       <tr>
       <td class="s">
           <a class="t" href="/web/20150418131915*/http://www.bayesian-inference.com/mcmcmwg" title="See a list of every capture for this URL">4 captures</a>
           <div class="r" title="Timespan for captures of this URL">11 Mar 15 - 2 Jul 15</div>
       </td>
       <td class="k">
       <a href="" id="wm-graph-anchor">
       <div id="wm-ipp-sparkline" title="Explore captures for this URL">
	 <img id="sparklineImgId" alt="sparklines"
		 onmouseover="__wm.st(1)" onmouseout="__wm.st(0)"
		 onmousemove="__wm.mv(event,this)"
		 width="525"
		 height="27"
		 border="0"
		 src="/web/jsp/graph.jsp?graphdata=525_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000000000_2005:-1:000000000000_2006:-1:000000000000_2007:-1:000000000000_2008:-1:000000000000_2009:-1:000000000000_2010:-1:000000000000_2011:-1:000000000000_2012:-1:000000000000_2013:-1:000000000000_2014:-1:000000000000_2015:3:001110100000_2016:-1:000000000000" />
       </div>
       </a>
       </td>
       </tr></tbody></table>
   </td>
   <td class="r">
       <a href="#close" onclick="__wm.h();return false;" style="background-image:url(/static/images/toolbar/wm_tb_close.png);top:5px;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="background-image:url(/static/images/toolbar/wm_tb_help.png);bottom:5px;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>
</div>
</div>
</div>
<script type="text/javascript">__wm.bt();</script>
<!-- END WAYBACK TOOLBAR INSERT -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36140535-1', 'bayesian-inference.com');
  ga('require','displayfeatures');
  ga('send', 'pageview');

</script>

<div id="view">
  <div id="head">
    <div id="logo">
      <a href="index" class="block"></a>
      <h1><a href="index"></a></h1>
      <h2><a href="index"></a></h2>
    </div>
    <hr class="hidden" />
    <div id="mainMenu">
      <ul>
  <li class="active"><a href="bayesian">Bayesian<span></span></a></li>
  <li><a href="computers">Computers<span></span></a></li>
  <li><a href="consulting">Consulting<span></span></a></li>
  <li><a target="_blank" href="forum/">Forum<span></span></a></li>
  <li><a href="merchandise">Merchandise<span></span></a></li>
  <li><a href="software">Software<span></span></a></li>
  <li><a href="support">Support<span></span></a></li>
</ul>
<form action="search" method="get" id="search" />
  <fieldset>
     <input type="text" name="search" value="Search" onfocus="if(this.value=='Search')this.value=''" class="button" />
    <input type="submit" value="" class="submit" />
  </fieldset>
</form>
    </div>
    <hr class="hidden" />
  </div>
  <div id="content">
    <div id="contentBlock">
      <div class="item last">
        <center><img src="/web/20150418131915im_/http://www.bayesian-inference.com/images/ban-mcmcmwg.png" alt="MANIAC I Picture" style="border: none;" /></center>
        <h2>Metropolis-within-Gibbs (MWG)</h2>

        <br>
        <table border="1" bordercolor="#454545">
        <!-- Elements in Row 1 -->
        <tr>
        <td><center><b>Aspect</b></center></td>
        <td><center><b>Description</b></center></td>
        <tr>
        <!-- Elements in Row 2 -->
        <tr>
        <td>Acceptance Rate</td>
        <td>The optimal acceptance rate is 44%, and is based on the univariate normality of each marginal posterior distribution. The observed acceptance rate may be suitable in the interval [15%,50%].</td>
        <tr>
        <!-- Elements in Row 3 -->
        <tr>
        <td>Applications</td>
        <td>This is a widely applicable, general-purpose algorithm.</td>
        <tr>
        <!-- Elements in Row 4 -->
        <tr>
        <td>Difficulty</td>
        <td>This algorithm is easy for a beginner when the proposal variance has been tuned with another algorithm. Otherwise, it may be tedious for the user to tune the proposal variance.</td>
        <tr>
        <!-- Elements in Row 5 -->
        <tr>
        <td>Final Algorithm?</td>
        <td>Yes.</td>
        <tr>
        <!-- Elements in Row 6 -->
        <tr>
        <td>Proposal</td>
        <td>Componentwise.</td>
        <tr>
        </tr>
        </table>
        <br>

        <p>Metropolis-within-Gibbs (MWG) is the original MCMC algorithm, introduced in Metropolis et al. (1953). Since it was the original MCMC algorithm, it pre-dated <a href="mcmcgibbs">Gibbs sampling</a> (Gibbs), and was not known as Metropolis-within-Gibbs. MWG was later proposed as a hybrid algorithm that combines Metropolis-Hastings and Gibbs sampling, and was suggested in Tierney (1994). The idea was to substitute a Metropolis step when Gibbs sampling fails. MWG is available in this respect in the Gibbs sampling algorithm. However, Gibbs sampling is not included in this particular version in <a href="software">LaplacesDemon</a> (or most versions), making it an algorithm with a misleading name. Without Gibbs sampling, the more honest name would be componentwise random-walk Metropolis, but the more common name is MWG. MWG is also referred to as Metropolis within Gibbs, Metropolis-in-Gibbs, Random-Walk Metropolis-within-Gibbs, single-site Metropolis, the Metropolis algorithm, or Variable-at-a-Time Metropolis.</p>

        <a name="componentwise"></a>
        <h3>Componentwise</h3>

        <p>MWG is a componentwise algorithm, meaning that each parameter is updated indvidually each iteration. This implies that the model specification function is evalulated a number of times equal to the number of parameters, per iteration. Componentwise sampling usually ignores parameter correlation. The order of the parameters for updating is randomized each iteration (random-scan MWG), as opposed to sequential updating (deterministic-scan MWG). MWG often uses <a href="mcmc#blockupdating">blocks</a>, and blockwise sampling may be specified with the algorithm specification <code>B</code>, in which a list is supplied, and each list component consists of a vector of parameters. Blocks are updated sequentially, but the order of parameters is randomized within each block.</p>

        <a name="metropolisstep"></a>
        <h3>Metropolis Step</h3>

        <p>The update of each parameter occurs in a Metropolis step, otherwise called an accept/reject step or a Metropolis accept/reject step. A componentwise proposal is generated randomly and the model is evaluated with the proposed parameter. If the proposal is an improvement in the logarithm of the unnormalized joint posterior density, then the proposal is accepted. If the proposal is not an improvement, then the proposal is accepted or rejected according to a probability.</p>

        <a name="acceptancerate"></a>
        <h3>Acceptance Rate</h3>

        <p>The acceptance rate is the total number of proposals accepted in the Metropolis step divided by the total number of iterations. If the acceptance rate is too high, then the proposal variance is too small. In this case, the algorithm will take longer than necessary to find the target distribution and the samples will be highly autocorrelated. If the acceptance rate is too low, then the proposal variance is too large, and the algorithm is ineffective at exploration. In the worst case scenario, no proposals are accepted and the algorithm fails to move. Under theoretical conditions, the optimal acceptance rate for a sole, independent and identically distributed (IID), Gaussian, marginal posterior distribution is 0.44 or 44%. The optimal acceptance rate for an infinite number of distributions that are IID and Gaussian is 0.234 or 23.4%. Since MWG is a componentwise algorithm, it is most efficient when the acceptance rate of each parameter is 0.44.</p>

        <a name="randomwalkbehavior"></a>
        <h3>Random-Walk Behavior</h3>

        <p>MWG is a componentwise <a href="mcmcrwm">Random-Walk Metropolis</a> (RWM) algorithm. Random-walk behavior is desirable because it allows the algorithm to explore, and hopefully avoid getting trapped in undesirable regions. On the other hand, random-walk behavior is undesirable because it takes longer to converge to the target distribution while the algorithm explores. The algorithm generally progresses in the right direction, but may periodically wander away. Such exploration may uncover multimodal target distributions, which other algorithms may fail to recognize, and then converge incorrectly. With enough iterations, MWG is guaranteed theoretically to converge to the correct target distribution, regardless of the starting point of each parameter, provided the proposal variance for each proposal of a target distribution is sensible.</p>

        <p>Historically, MWG first ran on an early computer that was built specifically for it, called MANIAC I. Metropolis discarded the first 16 iterations as burn-in, and updated an additional 48-64 iterations, which required 4-5 hours on MANIAC I.</p>

        <p>Roberts and Rosenthal (2007) introduced an adaptive version of Metropolis-within-Gibbs, called <a href="mcmcamwg">Adaptive Metropolis-within-Gibbs</a> (AMWG). Bai (2009) extended this to the <a href="mcmcadmg">Adaptive Directional Metropolis-within-Gibbs</a> (ADMG) algorithm.</p>

        <p>The advantage of MWG over the multivariate version, RWM, is that it is more efficient with information per iteration, so convergence is faster in iterations. The disadvantages of MWG are that covariance is not included in proposals, and it is more time-consuming due to the evaluation of the model specification function for each parameter per iteration. As the number of parameters increases, and especially as model complexity increases, the run-time per iteration increases. Since fewer iterations are completed in a given time-interval, the possible amount of thinning is also at a disadvantage. MWG is non-adaptive, and is suitable as a final algorithm.</p>

        <h3>References</h3>

        <ul>
          <li>Bai Y (2009). &quot;An Adaptive Directional Metropolis-within-Gibbs Algorithm.&quot; Technical Report in Department of Statistics at the University of Toronto.</li>
          <li>Metropolis N, Rosenbluth A, MN R, Teller E (1953). &quot;Equation of State Calculations by Fast Computing Machines.&quot; <i>Journal of Chemical Physics</i>, 21, 1087-1092.</li>
          <li>Roberts G, Rosenthal J (2007). &quot;Coupling and Ergodicity of Adaptive Markov Chain Monte Carlo Algorithms.&quot; <i>Journal of Applied Probability</i>, 44, 458-475.</li>
          <li>Tierney L (1994). &quot;Markov Chains for Exploring Posterior Distributions.&quot; <i>The Annals of Statistics</i>, 22(4), 1701-1762. With discussion and a rejoinder by the author.</li>
        </ul>

      </div>
    </div>
    <hr class="hidden" />
      <br><center>

<a href="index"><img src="/web/20150418131915im_/http://www.bayesian-inference.com/images/button-home.png" style="border: none;" onmouseover="show_text(0,'div1')" onmouseout="resetit('div1')" /></a>

<img src="/web/20150418131915im_/http://www.bayesian-inference.com/images/button-favorites.png" alt="Bookmark this page" style="border: none;" onclick="javascript:bookmarksite('Bayesian Inference', '/web/20150418131915/http://www.bayesian-inference.com')" onmouseover="show_text(1,'div1')" onmouseout="resetit('div1')" />

<img src="/web/20150418131915im_/http://www.bayesian-inference.com/images/button-email.png" style="border: none;" onclick="javascript:mailpage()" onmouseover="show_text(2,'div1')" onmouseout="resetit('div1')" /> 

<a href="suggestionbox"><img src="/web/20150418131915im_/http://www.bayesian-inference.com/images/button-suggestion.png" style="border: none;" onmouseover="show_text(3,'div1')" onmouseout="resetit('div1')" /></a>

<g:plusone annotation="none"></g:plusone>

<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = '/web/20150418131915/https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>

</center>

<span id="div1"> </span>
    <div id="menuBlock">
      <div class="box firstBox subMenu">
        <h3>See Also:</h3>
        <ul>
          <li><a href="bayesian">Bayesian</a></li>
          <li><a href="mcmc">MCMC</a></li>
          <li><a href="mcmcadmg">MCMC: ADMG</a></li>
          <li><a href="mcmcamwg">MCMC: AMWG</a></li>
          <li><a href="mcmcgibbs">MCMC: Gibbs</a></li>
          <li><a href="mcmcrwm">MCMC: RWM</a></li>
          <li><a href="numericalapproximation">Numerical Approximation</a></li>
          <li><a href="siteindex">Site Index</a></li>
          <li><a href="software">Software</a></li>
        </ul>
      </div>
      <div class="box boxText" itemscope itemtype="http://schema.org/LocalBusiness">
        <h3>Contact Information:</h3>
        <p><b><span itemprop="legalname">Statisticat, LLC.</span></b>
        <br><span itemprop="description">Statistical Consulting and Support</span>
        <div itemprop="address" itemscope itemtype="http://schema.org/PostalAddress">
          <span itemprop="addressLocality">Hot Springs</span>, <span itemprop="addressRegion">SD</span> <span itemprop="postalCode">57747</span> <span itemprop="addressCountry">USA</span></div>
        Status: Available <del>Booked</del>
        <br><span itemprop="email"><a href="mailto:webmaster@bayesian-inference.com">webmaster@bayesian-inference.com</a>
</span></p>
      </div>
    </div>
  </div>

  <div id="foot">
  <p class="fl">&copy; Statisticat, LLC., All Rights Reserved</p>
  <p class="fr"><a href="privacypolicy">Privacy Policy</a></p>
</div>

</div>

</body>
</html>





<!--
     FILE ARCHIVED ON 13:19:15 Apr 18, 2015 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 21:36:21 Oct 30, 2016.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
