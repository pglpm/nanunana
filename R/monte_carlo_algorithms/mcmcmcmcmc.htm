<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="cs" lang="cs">
<head>


<script type="text/javascript" src="/static/js/analytics.js"></script>
<script type="text/javascript">archive_analytics.values.server_name="wwwb-app17.us.archive.org";archive_analytics.values.server_ms=274;</script>
<link type="text/css" rel="stylesheet" href="/static/css/banner-styles.css"/>


<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="author" content="Statisticat, LLC." />
<meta name="copyright" content="Statisticat, LLC. - Statistical Consulting and Support" />
<meta name="description" content="The Metropolis-Coupled Markov Chain Monte Carlo (MCMCMC) algorithm is a parallel-chain extension of random-walk Metropolis for multimodal target densities." />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Metropolis-Coupled Markov Chain Monte Carlo</title>
<link rel="stylesheet" type="text/css" href="/web/20150418123330cs_/http://www.bayesian-inference.com/css/default.css" media="screen" />
<link rel="stylesheet" type="text/css" href="/web/20150418123330cs_/http://www.bayesian-inference.com/css/print.css" media="print" />
<link rel="shortcut icon" href="/web/20150418123330im_/http://www.bayesian-inference.com/favicon.ico" />
<script type="text/javascript">
function bookmarksite(title,url){
if (window.sidebar) // firefox
	window.sidebar.addPanel(title, url, "");
else if(window.opera && window.print){ // opera
	var elem = document.createElement('a');
	elem.setAttribute('href',url);
	elem.setAttribute('title',title);
	elem.setAttribute('rel','sidebar');
	elem.click();
} 
else if(document.all) // ie
	window.external.AddFavorite(url, title);
}
</script>
<script type="text/javascript">
var linktext=new Array()
linktext[0]="<center>Go to Home Page</center>"
linktext[1]="<center>Add to Favorites (Bookmark this Page)</center>"
linktext[2]="<center>Send Email to a Friend</center>"
linktext[3]="<center>Make a Suggestion</center>"
var ns6=document.getElementById&&!document.all
var ie=document.all
function show_text(thetext, whichdiv){
if (ie) eval("document.all."+whichdiv).innerHTML=linktext[thetext]
else if (ns6) document.getElementById(whichdiv).innerHTML=linktext[thetext]
}
function resetit(whichdiv){
if (ie) eval("document.all."+whichdiv).innerHTML=' '
else if (ns6) document.getElementById(whichdiv).innerHTML=' '
}
</script>
<script type="text/javascript">
function mailpage()
{
mail_str = "mailto:?subject=Check out this webpage: " + document.title;
mail_str += "&body=I thought you might be interested in this webpage: " + document.title;
mail_str += ". You can view it here: " + location.href;
location.href = mail_str;
}
</script>
</head>
<body>


<!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript">//<![CDATA[
var __wm = (function(imgWidth,imgHeight,yearImgWidth,monthImgWidth){
var wbPrefix = "/web/";
var wbCurrentUrl = "http://www.bayesian-inference.com/mcmcmcmcmc";

var firstYear = 1996;
var displayDay = "18";
var displayMonth = "Apr";
var displayYear = "2015";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
var $D=document,$=function(n){return document.getElementById(n)};
var trackerVal,curYear = -1,curMonth = -1;
var yearTracker,monthTracker;
function showTrackers(val) {
  if (val===trackerVal) return;
  var $ipp=$("wm-ipp");
  var $y=$("displayYearEl"),$m=$("displayMonthEl"),$d=$("displayDayEl");
  if (val) {
    $ipp.className="hi";
  } else {
    $ipp.className="";
    $y.innerHTML=displayYear;$m.innerHTML=displayMonth;$d.innerHTML=displayDay;
  }
  yearTracker.style.display=val?"inline":"none";
  monthTracker.style.display=val?"inline":"none";
  trackerVal = val;
}
function trackMouseMove(event,element) {
  var eventX = getEventX(event);
  var elementX = getElementX(element);
  var xOff = Math.min(Math.max(0, eventX - elementX),imgWidth);
  var monthOff = xOff % yearImgWidth;

  var year = Math.floor(xOff / yearImgWidth);
  var monthOfYear = Math.min(11,Math.floor(monthOff / monthImgWidth));
  // 1 extra border pixel at the left edge of the year:
  var month = (year * 12) + monthOfYear;
  var day = monthOff % 2==1?15:1;
  var dateString = zeroPad(year + firstYear) + zeroPad(monthOfYear+1,2) +
    zeroPad(day,2) + "000000";

  $("displayYearEl").innerHTML=year+firstYear;
  $("displayMonthEl").innerHTML=prettyMonths[monthOfYear];
  // looks too jarring when it changes..
  //$("displayDayEl").innerHTML=zeroPad(day,2);
  var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
  $("wm-graph-anchor").href=url;

  if(curYear != year) {
    var yrOff = year * yearImgWidth;
    yearTracker.style.left = yrOff + "px";
    curYear = year;
  }
  if(curMonth != month) {
    var mtOff = year + (month * monthImgWidth) + 1;
    monthTracker.style.left = mtOff + "px";
    curMonth = month;
  }
}
function hideToolbar() {
  $("wm-ipp").style.display="none";
}
function bootstrap() {
  var $spk=$("wm-ipp-sparkline");
  yearTracker=$D.createElement('div');
  yearTracker.className='yt';
  with(yearTracker.style){
    display='none';width=yearImgWidth+"px";height=imgHeight+"px";
  }
  monthTracker=$D.createElement('div');
  monthTracker.className='mt';
  with(monthTracker.style){
    display='none';width=monthImgWidth+"px";height=imgHeight+"px";
  }
  $spk.appendChild(yearTracker);
  $spk.appendChild(monthTracker);

  var $ipp=$("wm-ipp");
  $ipp&&disclaimElement($ipp);
}
return{st:showTrackers,mv:trackMouseMove,h:hideToolbar,bt:bootstrap};
})(525, 27, 25, 2);//]]>
</script>
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  min-width:800px !important;
}
</style>
<div id="wm-ipp" lang="en" style="display:none;">

<div style="position:fixed;left:0;top:0;width:100%!important">
<div id="wm-ipp-inside">
   <table style="width:100%;"><tbody><tr>
   <td id="wm-logo">
       <a href="/web/" title="Wayback Machine home page"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0" /></a>
   </td>
   <td class="c">
       <table style="margin:0 auto;"><tbody><tr>
       <td class="u" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://www.bayesian-inference.com/mcmcmcmcmc" style="width:400px;" onfocus="this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20150418123330" /><input type="submit" value="Go" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td class="n" rowspan="2">
           <table><tbody>
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr class="m">
           	<td class="b" nowrap="nowrap">
		
		    <a href="/web/20150311163351/http://www.bayesian-inference.com/mcmcmcmcmc" title="11 Mar 2015">MAR</a>
		
		</td>
		<td class="c" id="displayMonthEl" title="You are here: 12:33:30 Apr 18, 2015">APR</td>
		<td class="f" nowrap="nowrap">
		
		    <a href="/web/20150521145724/http://www.bayesian-inference.com/mcmcmcmcmc" title="21 May 2015"><strong>MAY</strong></a>
		
                </td>
	    </tr>
           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr class="d">
               <td class="b" nowrap="nowrap">
               
                   <a href="/web/20150311163351/http://www.bayesian-inference.com/mcmcmcmcmc" title="16:33:51 Mar 11, 2015"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
               
               </td>
               <td class="c" id="displayDayEl" style="width:34px;font-size:24px;" title="You are here: 12:33:30 Apr 18, 2015">18</td>
	       <td class="f" nowrap="nowrap">
               
		   <a href="/web/20150521145724/http://www.bayesian-inference.com/mcmcmcmcmc" title="14:57:24 May 21, 2015"><img src="/static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0" /></a>
	       
	       </td>
           </tr>
           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr class="y">
	       <td class="b" nowrap="nowrap">
               
                   2014
               
               </td>
               <td class="c" id="displayYearEl" title="You are here: 12:33:30 Apr 18, 2015">2015</td>
	       <td class="f" nowrap="nowrap">
               
                   2016
               
	       </td>
           </tr>
           </tbody></table>
       </td>
       </tr>
       <tr>
       <td class="s">
           <a class="t" href="/web/20150418123330*/http://www.bayesian-inference.com/mcmcmcmcmc" title="See a list of every capture for this URL">5 captures</a>
           <div class="r" title="Timespan for captures of this URL">7 Nov 14 - 3 Jul 15</div>
       </td>
       <td class="k">
       <a href="" id="wm-graph-anchor">
       <div id="wm-ipp-sparkline" title="Explore captures for this URL">
	 <img id="sparklineImgId" alt="sparklines"
		 onmouseover="__wm.st(1)" onmouseout="__wm.st(0)"
		 onmousemove="__wm.mv(event,this)"
		 width="525"
		 height="27"
		 border="0"
		 src="/web/jsp/graph.jsp?graphdata=525_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000000000_2005:-1:000000000000_2006:-1:000000000000_2007:-1:000000000000_2008:-1:000000000000_2009:-1:000000000000_2010:-1:000000000000_2011:-1:000000000000_2012:-1:000000000000_2013:-1:000000000000_2014:-1:000000000010_2015:3:001110100000_2016:-1:000000000000" />
       </div>
       </a>
       </td>
       </tr></tbody></table>
   </td>
   <td class="r">
       <a href="#close" onclick="__wm.h();return false;" style="background-image:url(/static/images/toolbar/wm_tb_close.png);top:5px;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="background-image:url(/static/images/toolbar/wm_tb_help.png);bottom:5px;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>
</div>
</div>
</div>
<script type="text/javascript">__wm.bt();</script>
<!-- END WAYBACK TOOLBAR INSERT -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36140535-1', 'bayesian-inference.com');
  ga('require','displayfeatures');
  ga('send', 'pageview');

</script>

<div id="view">
  <div id="head">
    <div id="logo">
      <a href="index" class="block"></a>
      <h1><a href="index"></a></h1>
      <h2><a href="index"></a></h2>
    </div>
    <hr class="hidden" />
    <div id="mainMenu">
      <ul>
  <li class="active"><a href="bayesian">Bayesian<span></span></a></li>
  <li><a href="computers">Computers<span></span></a></li>
  <li><a href="consulting">Consulting<span></span></a></li>
  <li><a target="_blank" href="forum/">Forum<span></span></a></li>
  <li><a href="merchandise">Merchandise<span></span></a></li>
  <li><a href="software">Software<span></span></a></li>
  <li><a href="support">Support<span></span></a></li>
</ul>
<form action="search" method="get" id="search" />
  <fieldset>
     <input type="text" name="search" value="Search" onfocus="if(this.value=='Search')this.value=''" class="button" />
    <input type="submit" value="" class="submit" />
  </fieldset>
</form>
    </div>
    <hr class="hidden" />
  </div>
  <div id="content">
    <div id="contentBlock">
      <div class="item last">
        <center><img src="/web/20150418123330im_/http://www.bayesian-inference.com/images/ban-mcmcmcmcmc.png" alt="Coupled Picture" style="border: none;" /></center>
        <h2>Metropolis-Coupled Markov Chain Monte Carlo (MCMCMC)</h2>

        <br>
        <table border="1" bordercolor="#454545">
        <!-- Elements in Row 1 -->
        <tr>
        <td><center><b>Aspect</b></center></td>
        <td><center><b>Description</b></center></td>
        <tr>
        <!-- Elements in Row 2 -->
        <tr>
        <td>Acceptance Rate</td>
        <td>The optimal acceptance rate is based on the multivariate normality of the marginal posterior distributions, and ranges from 44% for one parameter to 23.4% for five or more parameters. The observed acceptance rate may be suitable in the interval [15%,50%].</td>
        <tr>
        <!-- Elements in Row 3 -->
        <tr>
        <td>Applications</td>
        <td>This is a widely applicable, general-purpose algorithm that specializes in representing multimodal distributions.</td>
        <tr>
        <!-- Elements in Row 4 -->
        <tr>
        <td>Difficulty</td>
        <td>This algorithm is moderately difficult for a beginner, because the proposal covariance must be tuned, the swap acceptance rate should be tuned, and the number of CPUs selected.</td>
        <tr>
        <!-- Elements in Row 5 -->
        <tr>
        <td>Final Algorithm?</td>
        <td>Yes.</td>
        <tr>
        <!-- Elements in Row 6 -->
        <tr>
        <td>Proposal</td>
        <td>Componentwise.</td>
        <tr>
        </tr>
        </table>
        <br>

        <p>The Metropolis-Coupled Markov Chain Monte Carlo (MCMCMC) algorithm -- also referred to as MC<sup>3</sup>, (MC)<sup>3</sup>, Metropolis-Coupled MCMC, Parallel Tempering, or Replica Exchange -- was introduced by Geyer (1991) for multimodal distributions. The name &quot;parallel tempering&quot; was introduced in Earl and Deem (2005).</p>

        <p>MCMCMC consists of parallel chains that use different temperatures and combine to form a mixture distribution, where each chain is a mixture component. The chains or mixture components are updated in parallel, each with a Metropolis step that is adjusted by temperature. After this first set of Metropolis steps, two parallel chains are selected at random, and another adjusted Metropolis step is used to accept or reject a swap between chains. The act of swapping is referred to as coupling. Each swap may be a jump between modes. MCMCMC has both within-chain and between-chain proposals each iteration, but only the coolest chain is retained.</p>

        <p>MCMCMC has four algorithm specifications: <code>lambda</code> is either a positive-only scalar that controls the temperature spacing or a vector of temperature spacings, <code>CPUs</code> is the number of central processing units in the computer, <code>Packages</code> is a vector of any package names that are required, and <code>Dyn.libs</code> are any dynamic libaries that are required. A larger scalar value of &lambda; results in greater differences in temperature between chains, and often a lower swap acceptance rate (see below). Given a scalar &lambda; and <i>m=1,...,M</i> CPUs, the current or proposal distribution is exponentiated to this power: <i>1/[1 + </i>&lambda;<i>(m - 1)]</i>. The number of CPUs must be at least two; as programmed, MCMCMC will not function on a single-core computer.</p>

        <p>MCMCMC must be called with <code>LaplacesDemon</code>, not <code>LaplacesDemon.hpc</code>, even though MCMCMC requires parallel chains. Each iteration, LaplacesDemon communicates with all CPUs, collects the latest for all the chains, and then the master process calculates the Metropolis steps for each chain, as well as the swap.</p>

        <p>As with <a href="mcmcrwm">Random-Walk Metropolis</a> (RWM), the proposal covariance matrix must be tuned. When nothing is known about this matrix, as is often the case, it is suggested to begin with an identity matrix with small-scale diagonal values, such as 1e-3. After a short run that hopefully has some acceptances, another short run can begin with the observed historical covariance matrix. Eventually, the proposal covariance matrix is usually satisfactory.</p>

        <p>Atchade et al. (2011) demonstrate that MCMCMC performance improves as the acceptance rate of proposed swaps approaches 0.234. In <code>LaplacesDemon</code>, the swap acceptance rate is printed to the console at the end of each update. The swap acceptance rate is affected by the temperature spacing between parallel chains. If the default temperature spacing that results from a scalar &lambda; is unacceptable, then a different scalar value may be attempted, or the user may enter their own temperature spacing directly as a vector for &lambda;.</p>

        <p>Coupling induces dependence among the chains, and the chains are no longer Markovian. The whole stochastic process of <i>m</i> chains together does form a Markov chain.</p>

        <p>Along with the J-walking algorithm of Frantz et al. (1990), MCMCMC was one of the first extensions of Metropolis-Hastings for multimodal distributions. Many additional MCMC algorithms, such as serial tempering or simulated tempering, were influenced by or variations of MCMCMC.</p>

        <p>The advantage of MCMCMC over RWM is that MCMCMC is better able to approximate multimodal distributions, and that successful coupling (swaps) improves mixing. A disadvantage is that most of the information in the warmer chains is lost, speed per iteration is slower than RWM due to communication with CPUs, and distributions with many modes require at least as many CPUs. Since MCMCMC is not adaptive, it is suitable as a final algorithm.</p>

        <h3>References</h3>

        <ul>
          <li>Atchade YF, Roberts GO, Rosenthal JS (2011). &quot;Towards Optimal Scaling of Metropolis-Coupled Markov Chain Monte Carlo.&quot; <i>Statistics and Computing</i>, 21(4), 555-568.</li>
          <li>Earl, DJ and Deem, MW (2005). &quot;Parallel Tempering: Theory, Applications, and New Perspectives.&quot; <i>Physical Chmeistry Chemical Phyiscs</i>, 7, 3910-3916.</li>
          <li>Frantz DD, Freeman JD and Doll JL (1990). &quot;Reducing Quasi-Ergodic Behavior in Monte Carlo Simulations by J-Walking: Applications to Atomic Clusters.&quot; <i>Journal of Chemical Physics</i>, 93, 2769-2784.</li>
          <li>Geyer CJ (1991). &quot;Markov Chain Monte Carlo Maximum Likelihood.&quot; In Keramidas, E.M. <i>Computing Science and Statistics: Proceedings of the 23rd Symposium of the Interface</i>. Fairfax Station VA: Interface Foundation. p. 156-163.</li>
        </ul>

      </div>
    </div>
    <hr class="hidden" />
      <br><center>

<a href="index"><img src="/web/20150418123330im_/http://www.bayesian-inference.com/images/button-home.png" style="border: none;" onmouseover="show_text(0,'div1')" onmouseout="resetit('div1')" /></a>

<img src="/web/20150418123330im_/http://www.bayesian-inference.com/images/button-favorites.png" alt="Bookmark this page" style="border: none;" onclick="javascript:bookmarksite('Bayesian Inference', '/web/20150418123330/http://www.bayesian-inference.com')" onmouseover="show_text(1,'div1')" onmouseout="resetit('div1')" />

<img src="/web/20150418123330im_/http://www.bayesian-inference.com/images/button-email.png" style="border: none;" onclick="javascript:mailpage()" onmouseover="show_text(2,'div1')" onmouseout="resetit('div1')" /> 

<a href="suggestionbox"><img src="/web/20150418123330im_/http://www.bayesian-inference.com/images/button-suggestion.png" style="border: none;" onmouseover="show_text(3,'div1')" onmouseout="resetit('div1')" /></a>

<g:plusone annotation="none"></g:plusone>

<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = '/web/20150418123330/https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>

</center>

<span id="div1"> </span>
    <div id="menuBlock">
      <div class="box firstBox subMenu">
        <h3>See Also:</h3>
        <ul>
          <li><a href="bayesian">Bayesian</a></li>
          <li><a href="mcmc">MCMC</a></li>
          <li><a href="mcmcrwm">MCMC: RWM</a></li>
          <li><a href="numericalapproximation">Numerical Approximation</a></li>
          <li><a href="siteindex">Site Index</a></li>
          <li><a href="software">Software</a></li>
        </ul>
      </div>
      <div class="box boxText" itemscope itemtype="http://schema.org/LocalBusiness">
        <h3>Contact Information:</h3>
        <p><b><span itemprop="legalname">Statisticat, LLC.</span></b>
        <br><span itemprop="description">Statistical Consulting and Support</span>
        <div itemprop="address" itemscope itemtype="http://schema.org/PostalAddress">
          <span itemprop="addressLocality">Hot Springs</span>, <span itemprop="addressRegion">SD</span> <span itemprop="postalCode">57747</span> <span itemprop="addressCountry">USA</span></div>
        Status: Available <del>Booked</del>
        <br><span itemprop="email"><a href="mailto:webmaster@bayesian-inference.com">webmaster@bayesian-inference.com</a>
</span></p>
      </div>
    </div>
  </div>

  <div id="foot">
  <p class="fl">&copy; Statisticat, LLC., All Rights Reserved</p>
  <p class="fr"><a href="privacypolicy">Privacy Policy</a></p>
</div>

</div>

</body>
</html>





<!--
     FILE ARCHIVED ON 12:33:30 Apr 18, 2015 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 21:36:21 Oct 30, 2016.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
