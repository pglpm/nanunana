<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Model Specification Time</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">
</head><body>

<table width="100%" summary="page for Model.Specification.Time {LaplacesDemon}"><tr><td>Model.Specification.Time {LaplacesDemon}</td><td align="right">R Documentation</td></tr></table>

<h2>Model Specification Time</h2>

<h3>Description</h3>


<p>The <code>Model.Spec.Time</code> function returns the time in minutes to
evaluate a model specification a number of times, as well as
the evaluations per minute, and componentwise iterations per minute.
</p>


<h3>Usage</h3>

<pre>
Model.Spec.Time(Model, Initial.Values, Data, n=1000)
</pre>


<h3>Arguments</h3>


<table summary="R argblock">
<tr valign="top"><td><code>Model</code></td>
<td>
<p>This requried argument is a model specification
function. For more information, see <code><a href="../../LaplacesDemon/html/LaplacesDemon.html">LaplacesDemon</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>Initial.Values</code></td>
<td>
<p>This required argument is a vector of initial
values for the parameters.</p>
</td></tr>
<tr valign="top"><td><code>Data</code></td>
<td>
<p>This required argument is a list of data. For more
information, see <code><a href="../../LaplacesDemon/html/LaplacesDemon.html">LaplacesDemon</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
<p>This is the number of evaluations of the model specification,
and accuracy increases with <code>n</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<p>The largest single factor to affect the run-time of an algorithm &ndash;
whether it is with <code><a href="../../LaplacesDemon/html/LaplaceApproximation.html">LaplaceApproximation</a></code>,
<code><a href="../../LaplacesDemon/html/LaplacesDemon.html">LaplacesDemon</a></code>, or <code><a href="../../LaplacesDemon/html/PMC.html">PMC</a></code> &ndash; is the time that
it takes to evaluate the model specification. This has also been
observed in Rosenthal (2007). It is highly recommended that a user of
the <code>LaplacesDemon</code> package should attempt to reduce the run-time
of the model specification, usually by testing alternate forms of code
for speed.
</p>
<p>A model specification function that is optimized for speed and
involves many records may result in a model update run-time that is
considerably less than other popular MCMC-based software algorithms
that loop through records, even when those algorithms are coded in
<code>C</code> or other fast languages. For a comparison, see the
&ldquo;Laplace's Demon Tutorial&rdquo; vignette.
</p>
<p>However, if a model specification function in the <code>LaplacesDemon</code>
package is not fully vectorized (contains <code>for</code> loops and
<code>apply</code> functions), then run-time will typically be slower than
other popular MCMC-based software algorithms.
</p>
<p>Distributions in the <code>LaplacesDemon</code> package usually have logical
checks to ensure correctness. These checks may slow the 
calculation of the density, for example. If the user is confident
these checks are unnecessary for their model, then the user may
comment-out the checks to improve speed.
</p>
<p>Examples in the <code>LaplacesDemon</code> package are not necessarily
optimized for speed, which is often compromised for clarity of
programming. For instace, most examples in the &ldquo;Examples&rdquo; vignette
use the <code>grep</code> function to find the position of a parameter based
on an associated parameter name. This makes the model specification
function much more readable, and also makes it easy to modify by
changing the number and position of parameters, such as when a user
experiments with the model form, or changes it from the example data
to actual data. However, the <code>grep</code> function is much slower than
specifying the exact location. There are many other instances in the
examples that demonstrate user-friendly code and are not optimized for
speed.
</p>
<p>When speed is of paramount importance, a user is encouraged to
experiment with writing the model specification function in another
language such as <code>C</code> or <code>Fortran</code>, and calling the new
function from within the <code>Model</code> function with the <code>.C</code> or
<code>.Fortran</code> function. This experimentation has not yet been done,
but should generally be worth the effort only when the model
specification is vectorized in the faster language as well. One
suggestion may be to browse for <code>R</code> packages on CRAN that enable
a user to speed up <code>R</code> code by incorporating <code>C</code> and other
languages.
</p>
<p>Another use for <code>Model.Spec.Time</code> is to allow the user to make an
informed decision about which MCMC algorithm to select, given the
speed of their model specification. For example, the Adaptive
Metropolis-within-Gibbs (AMWG) of Roberts and Rosenthal (2009) is
currently the adaptive MCMC algorithm of choice in general in many
cases, but this choice is conditional on run-time. While the other
MCMC algorithms in <code>LaplacesDemon</code> evaluate the model
specification function once per iteration, componentwise algorithms
such as in the MWG family evaluate it once per parameter per
iteration, significantly increasing run-time per iteration in large
models. The <code>Model.Spec.Time</code> may forewarn the user of the
associated run-time, and if it should be decided to go with an
alternate MCMC algorithm, such as AMM, in which each element of its
covariance matrix must stabilize for the chains to become
stationary. AMM, for example, will require many more iterations of 
burn-in (for more information, see the <code><a href="../../LaplacesDemon/html/burnin.html">burnin</a></code> function),
but with numerous iterations, allows more thinning. A general
recommendation may be to use AMWG when
<code>Componentwise.Iters.per.Minute</code> &gt;= 1000, but this is subjective
and best determined by each user for each model. A better decision may
be made by comparing MCMC algorithms with the <code><a href="../../LaplacesDemon/html/Juxtapose.html">Juxtapose</a></code>
function for a particular model.
</p>
<p>Following are a few common suggestions for increasing the speed of
<code>R</code> code in the model specification function. There are often
exceptions to these suggestions, so case-by-case experimentation is
also suggested.
</p>

<ul>
<li><p> Replace exponents with multiplied terms, such as <code>x^2</code>
with <code>x*x</code>.
</p>
</li>
<li><p> Replace <code>mean(x)</code> with <code>sum(x)/length(x)</code>.
</p>
</li>
<li><p> Replace parentheses (when possible) with curly brackets.
</p>
</li>
<li><p> Replace <code>tcrossprod(Data$X, t(beta))</code> with
<code>Data$X %*% beta</code> when there are few predictors, and avoid
<code>tcrossprod(beta, Data$X)</code>, which is always slowest.
</p>
</li>
<li><p> Specify parameters directly, such as <code>parm[53]</code>, rather
than with <code>grep</code>.
</p>
</li>
<li><p> Vectorize functions and eliminate <code>apply</code> and <code>for</code>
functions. There are often specialized functions. For example,
<code>max.col(X)</code> is faster than <code>apply(X, 1, which.max)</code>.
</p>
</li></ul>



<h3>Value</h3>


<p>The <code>Model.Spec.Time</code> function returns a list with three
components:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>Time</code></td>
<td>
<p>This is the time in minutes to evaluate the model
specification <code>n</code> times.</p>
</td></tr>
<tr valign="top"><td><code>Evals.per.Minute</code></td>
<td>
<p>This is the number of evaluations of the
model specification per minute: <code>n</code> / <code>Time</code>. This is also
the number of iterations per minute in an algorithm that is not
componentwise, where one evaluation occurs per iteration.</p>
</td></tr>
<tr valign="top"><td><code>Componentwise.Iters.per.Minute</code></td>
<td>
<p>This is the number of iterations
per minute in a componentwise MCMC algorithm, such as AMWG or
MWG. It is the evaluations per minute divided by the number of
parameters, since an evaluation must occur for each parameter, for
each iteration.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Byron Hall <a href="mailto:statisticat@gmail.com">statisticat@gmail.com</a></p>


<h3>References</h3>


<p>Hall, B. (2012). &quot;Laplace's Demon&quot;, STATISTICAT, LLC.
URL=<a href="http://www.statisticat.com/laplacesdemon.html">http://www.statisticat.com/laplacesdemon.html</a>
</p>
<p>Roberts, G.O. and Rosenthal, J.S. (2009). &quot;Examples of Adaptive
MCMC&quot;. Computational Statistics and Data Analysis, 18, p. 349&ndash;367.
</p>


<h3>See Also</h3>


<p><code><a href="../../LaplacesDemon/html/.C.html">.C</a></code>,
<code><a href="../../LaplacesDemon/html/.Fortran.html">.Fortran</a></code>,
<code><a href="../../LaplacesDemon/html/apply.html">apply</a></code>,
<code><a href="../../LaplacesDemon/html/grep.html">grep</a></code>,
<code><a href="../../LaplacesDemon/html/Juxtapose.html">Juxtapose</a></code>,
<code><a href="../../LaplacesDemon/html/LaplaceApproximation.html">LaplaceApproximation</a></code>,
<code><a href="../../LaplacesDemon/html/LaplacesDemon.html">LaplacesDemon</a></code>,
<code><a href="../../LaplacesDemon/html/max.col.html">max.col</a></code>,
<code><a href="../../LaplacesDemon/html/PMC.html">PMC</a></code>, and
<code><a href="../../LaplacesDemon/html/system.time.html">system.time</a></code>.
</p>

<hr><div align="center">[Package <em>LaplacesDemon</em> version 12.08.06 <a href="00Index.html">Index</a>]</div>
</body></html>