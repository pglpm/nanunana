<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Matrix Utility Functions</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">
</head><body>

<table width="100%" summary="page for Matrices {LaplacesDemon}"><tr><td>Matrices {LaplacesDemon}</td><td align="right">R Documentation</td></tr></table>

<h2>Matrix Utility Functions</h2>

<h3>Description</h3>


<p>These are utility functions for working with matrices.
</p>


<h3>Usage</h3>

<pre>
as.indicator.matrix(x)
as.inverse(x)
as.parm.matrix(x, k, parm, Data, a=-Inf, b=Inf, restrict=FALSE, chol=FALSE)
as.positive.definite(x)
as.positive.semidefinite(x)
as.symmetric.matrix(x, k=NULL)
is.positive.definite(x)
is.positive.semidefinite(x)
is.square.matrix(x)
is.symmetric.matrix(x)
Cov2Cor(Sigma)
Hessian(Model, parm, Data)
lower.triangle(x, diag=FALSE)
read.matrix(file, header=FALSE, sep="", skip=0, na.rm=FALSE)
tr(x)
upper.triangle(x, diag=FALSE)
</pre>


<h3>Arguments</h3>


<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>This is a matrix (though <code>as.symmetric.matrix</code> also
accepts vectors).</p>
</td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
<p>For <code>as.parm.matrix</code>, this is a required argument,
indicating the dimension of the matrix. For
<code>as.symmetric.matrix</code>, this is an optional argument that
specifies the dimension of the symmetric matrix. This applies
only when <code>x</code> is a vector. It defaults to <code>NULL</code>,
in which case it calculates <code>k &lt;- (-1 + sqrt(1 + 8 * length(x))) / 2</code>.</p>
</td></tr>
<tr valign="top"><td><code>diag</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then the elements in the main
diagonal are also returned.</p>
</td></tr>
<tr valign="top"><td><code>Sigma</code></td>
<td>
<p>This is a covariance matrix, <i>Sigma</i>, and may
be entered either as a matrix or vector.</p>
</td></tr>
<tr valign="top"><td><code>Model</code></td>
<td>
<p>This is a model specification function. For more
information, see <code><a href="../../LaplacesDemon/html/LaplacesDemon.html">LaplacesDemon</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>parm</code></td>
<td>
<p>This is a vector of parameters passed to the model
specification.</p>
</td></tr>
<tr valign="top"><td><code>Data</code></td>
<td>
<p>This is the list of data passed to the model
specification. For more information, see <code><a href="../../LaplacesDemon/html/LaplacesDemon.html">LaplacesDemon</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>a,b</code></td>
<td>
<p>These optional arguments allow the elements of <code>x</code> to
be bound to the interval <i>[a,b]</i>. For example, elements of a
correlation matrix are in the interval <i>[-1,1]</i>.</p>
</td></tr>
<tr valign="top"><td><code>restrict</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then <code>x[1,1]</code> is
restricted to 1. This is useful in multinomial probit, for
example. Be aware that a global variable, <code>LaplacesDemonMatrix</code>, is
created so <code>as.parm.matrix</code> can keep track of changes from
iteration to iteration.</p>
</td></tr>
<tr valign="top"><td><code>chol</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then x is an upper-triangular
matrix.</p>
</td></tr>
<tr valign="top"><td><code>file</code></td>
<td>
<p>This is the name of the file from which the data will be
imported or read.</p>
</td></tr>
<tr valign="top"><td><code>header</code></td>
<td>
<p>Logical. When <code>TRUE</code>, the first row of the file
must contain names of the columns, and will be converted to the
column names of the numeric matrix. When <code>FALSE</code>, the first row
of the file contains data, not column names.</p>
</td></tr>
<tr valign="top"><td><code>sep</code></td>
<td>
<p>This argument indicates a character with which it will
separate fields when creating column vectors. For example, a
read a comma-separated file (.csv), use <code>sep=","</code>.</p>
</td></tr>
<tr valign="top"><td><code>skip</code></td>
<td>
<p>This is the number of rows to skip before beginning to
read data.</p>
</td></tr>
<tr valign="top"><td><code>na.rm</code></td>
<td>
<p>Logical. When <code>TRUE</code>, rows with missing values are
removed from the matrix after it is read. Rather than removing
missing values, the user may consider imputing missing values inside
the model. Examples of imputation may be found in the accompanying
&quot;Examples&quot; vignette.</p>
</td></tr>
</table>


<h3>Details</h3>


<p>The <code>as.indicator.matrix</code> function creates an indicator matrix
from a vector. This function is useful for converting a discrete
vector into a matrix in which each column represents one of the
discrete values, and each occurence of that value in the related
column is indicated by a one, and is otherwise filled with
zeroes. This function is similar to the <code>class.ind</code> function in
the nnet package.
</p>
<p>The <code>as.inverse</code> function returns the matrix inverse of
<code>x</code>. The <code>solve</code> function in base R also returns the matrix
inverse, but <code>solve</code> can return a matrix that is not symmetric,
and can fail due to singularities. The <code>as.inverse</code> function
tries to use the <code>solve</code> function to return a matrix inverse, and
when it fails due to a singularity, <code>as.inverse</code> uses eigenvalue
decomposition (in which eigenvalues below a tolerance are replaced
with the tolerance), and coerces the result to a symmetric
matrix. This is similar to the <code>solvcov</code> function in the fpc
package.
</p>
<p>The <code>as.parm.matrix</code> function prepares a correlation, covariance,
or precision matrix in two important ways. First,
<code>as.parm.matrix</code> obtains the parameters for the matrix specified
in the <code>x</code> argument by matching the name of the matrix in the
<code>x</code> argument with any parameters in <code>parm</code>, given the
parameter names in the <code>Data</code> listed in <code>parm.names</code>. These
obtained parameters are organized into a matrix as the elements of the
upper-triangular, including the diagonal. A copy is made, without the
diagonal, and the lower-triangular is filled in, completing the
matrix. Second, <code>as.parm.matrix</code> checks for
positive-definiteness. If matrix <code>x</code> is positive-definite, then
the matrix is stored as a global variable,
<code>LaplacesDemonMatrix</code>. If matrix <code>x</code> is not
positive-definite, then the global variable,
<code>LaplacesDemonMatrix</code>, is sought as a replacement. If the global
variable exists, then it is used to replace the matrix. If not, then
the matrix is replaced with an identity matrix. Back in the model
specification, after using <code>as.parm.matrix</code>, it is recommended
that the user also pass the resulting matrix back into the <code>parm</code>
vector, so the sampler or algorithm knows that the elements of the
matrix have changed.
</p>
<p>The <code>as.positive.definite</code> function returns the nearest
positive-definite matrix for a matrix that is square and symmetric
(Higham, 2002). This version is intended only for covariance and
precision matrices, and has been optimized for speed. A more
extensible function is <code>nearPD</code> in the matrixcalc package, which
is also able to work with correlation matrices, and matrices that are
asymmetric.
</p>
<p>The <code>as.positive.semidefinite</code> function iteratively seeks to
return a square, symmetric matrix that is at least
positive-semidefinite, by replacing each negative eigenvalue and
calculating its projection. This is intended only for covariance and
precision matrices. A similar function is <code>makePsd</code> in the RTAQ
package, though it is not iterative, and returns matrices that fail a
logical check with <code>is.positive.semidefinite</code>.
</p>
<p>The <code>as.symmetric.matrix</code> function accepts either a vector or
matrix, and returns a symmetric matrix. In the case of a vector, it
can be either all elements of the matrix, or the lower triangular. In
the case of a <code>x</code> being entered as a matrix, this function
tolerates non-finite values in one triangle (say, the lower), as long
as the corresponding element is finite in the other (say, the upper)
triangle.
</p>
<p>The <code>Cov2Cor</code> function converts a covariance matrix into a
correlation matrix, and accepts the covariance matrix either in matrix
or vector form. This function may be useful inside a model
specification and also with converting posterior draws of the elements
of a covariance matrix to a correlation matrix. <code>Cov2Cor</code> is an
expanded form of the <code>cov2cor</code> function in the <code>stats</code>
package, where <code>Cov2Cor</code> is also able to accept and return a
vectorized matrix.
</p>
<p>The <code>Hessian</code> returns a symmetric, Hessian matrix, which is a
matrix of second partial derivatives. The estimation of the Hessian
matrix is approximated numerically using finite differences, as shown
in Gelman et al. (2004, p. 313&ndash;314), though with a tolerance of
<i>1e-06</i>. This is a slow function, and to reduce estimation time,
the <code>Model</code> function is evaulated only for the upper triangular
of this matrix, and the lower triangular is copied. This function is
not intended to be called by the user, but is made available here.
Automatic differentiation (AD) is an improvement over
finite-differencing, but is currently unavailable here.
</p>
<p>The <code>is.positive.definite</code> function is a logical test of whether
or not a matrix is positive-definite. A <i>k x k</i>
symmetric matrix <i>X</i> is positive-definite if all of
its eigenvalues are positive (<i>lambda[i] &gt;
  0, i in k</i>). All main-diagonal elements must be positive. The
determinant of a positive-definite matrix is always positive, so a
positive-definite matrix is always nonsingular. Non-symmetric,
positive-definite matrices exist,but are not considered here.
</p>
<p>The <code>is.positive.semidefinite</code> function is a logical test of
whether or not a matrix is positive-semidefinite. A <i>k x k</i>
symmetric matrix <i>X</i> is positive-semidefinite if all
of its eigenvalues are non-negative (<i>lambda[i] &gt;= 0, i ink</i>).
</p>
<p>The <code>is.square.matrix</code> function is a logical test of whether or
not a matrix is square. A square matrix is a matrix with the same
number of rows and columns, and is usually represented as a <i>k x k</i> matrix <i>X</i>.
</p>
<p>The <code>is.symmetric.matrix</code> function is a logical test of whether
or not a matrix is symmetric. A symmetric matrix is a square matrix
that is equal to its transpose, <i>X =
  t(X)</i>. For example, where <i>i</i> indexes rows and <i>j</i> indexes
columns, <i>X[i,j] =
  X[j,i]</i>. This differs from the <code>isSymmetric</code> function in base R
that is inexact, using <code>all.equal</code>.
</p>
<p>The <code>lower.triangle</code> function returns a vector of the lower
triangular elements of a matrix, and the diagonal is included when
<code>diag=TRUE</code>.
</p>
<p>The <code>read.matrix</code> function is provided here as one of many
convenient ways to read a numeric matrix into R. The most common
method of storing data in R is the data frame, because it is
versatile. For example, a data frame may contain character, factor,
and numeric variables together. For iterative estimation, common in
Bayesian inference, the data frame is much slower than the numeric
matrix. For this reason, the Laplace's Demon package does not use data
frames, and has not traditionally accepted character or factor
data. This function is similar to the <code>read.matrix</code> function in
the tseries package, with the addition of the <code>na.rm</code>
argument. The <code>read.matrix</code> function returns a numeric matrix.
</p>
<p>The <code>tr</code> function returns the trace of a matrix. The trace of a
matrix is the sum of the elements in the main diagonal of a square
matrix. For example, the trace of a <i>k x k</i> matrix
<i>X</i>, is <i>sum(k=1)
  X[k,k]</i>.
</p>
<p>The <code>upper.triangle</code> function returns a vector of the lower
triangular elements of a matrix, and the diagonal is included when
<code>diag=TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Byron Hall <a href="mailto:statisticat@gmail.com">statisticat@gmail.com</a></p>


<h3>References</h3>


<p>Gelman, A., Carlin, J., Stern, H., and Rubin, D. (2004). &quot;Bayesian
Data Analysis, Texts in Statistical Science, 2nd ed.&quot;. Chapman and
Hall, London.
</p>
<p>Higham, N.J. (2002). &quot;Computing the Nearest Correlation Matrix - a
Problem from Finance&quot;. IMA Journal of Numerical Analysis, 22,
p. 329&ndash;343.
</p>


<h3>See Also</h3>


<p><code><a href="../../LaplacesDemon/html/Cov2Prec.html">Cov2Prec</a></code>,
<code><a href="../../LaplacesDemon/html/cov2cor.html">cov2cor</a></code>,
<code><a href="../../LaplacesDemon/html/isSymmetric.html">isSymmetric</a></code>,
<code><a href="../../LaplacesDemon/html/LaplaceApproximation.html">LaplaceApproximation</a></code>,
<code><a href="../../LaplacesDemon/html/LaplacesDemon.html">LaplacesDemon</a></code>,
<code><a href="../../LaplacesDemon/html/lower.tri.html">lower.tri</a></code>,
<code><a href="../../LaplacesDemon/html/Prec2Cov.html">Prec2Cov</a></code>
<code><a href="../../LaplacesDemon/html/solve.html">solve</a></code>, and
<code><a href="../../LaplacesDemon/html/upper.tri.html">upper.tri</a></code>.
</p>

<hr><div align="center">[Package <em>LaplacesDemon</em> version 12.08.06 <a href="00Index.html">Index</a>]</div>
</body></html>