<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Propriety</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">
</head><body>

<table width="100%" summary="page for is.proper {LaplacesDemon}"><tr><td>is.proper {LaplacesDemon}</td><td align="right">R Documentation</td></tr></table>

<h2>Propriety</h2>

<h3>Description</h3>


<p>This function provides a logical check of the propriety of a
univariate prior probability distribution or the joint posterior
distribution.
</p>


<h3>Usage</h3>

<pre>
is.proper(f,a,b,tol)
</pre>


<h3>Arguments</h3>


<table summary="R argblock">
<tr valign="top"><td><code>f</code></td>
<td>
<p>This is either a probability density function or an object of
class <code>demonoid</code>, <code>laplace</code>, or <code>pmc</code>.</p>
</td></tr>
<tr valign="top"><td><code>a</code></td>
<td>
<p>This is the lower limit of integration, and may be negative
infinity.</p>
</td></tr>
<tr valign="top"><td><code>b</code></td>
<td>
<p>This is the upper limit of integration, and may be positive
infinity.</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>
<p>This is the tolerance, and indicates the difference from 1,
where the integrated area above this result is treated as 1.</p>
</td></tr>
</table>


<h3>Details</h3>


<p>A proper probability distribution is a probability distribution that
integrates to 1, and an improper probability distribution does not
integrate to 1.
</p>
<p>In Bayesian inference, the posterior probability distribution should
be proper. An improper prior distribution can cause an improper
posterior distribution. When the posterior distribution is improper,
inferences are invalid, it is non-integrable, and Bayes factors cannot
be used (though there are exceptions).
</p>
<p>To avoid these problems, it is suggested that the prior probability
distribution should be proper, though it is possible to use an
improper prior distribution and have it result in a proper posterior
distribution.
</p>
<p>To check the propriety of a univariate prior probability distribution,
create a function <code>f</code>. For example, to check the propriety of a
vague normal distribution, such as
</p>
<p align="center"><i>theta ~ N(0,1000)</i></p>

<p>the function is <code>function(x){dnormv(x,0,1000)}</code>. Next, set the
lower and upper limits of integration, <code>a</code> and
<code>b</code>. Internally, this function calls <code>integrate</code> from base
R, which uses adaptive quadrature. By using <i>f(x)</i> as shorthand
for the specified function, <code>is.proper</code> will check to see if the
area of the following integral is one:
</p>
<p align="center"><i>integral from a to b of f(x)dx</i></p>

<p>Multivariate prior probability distributions currently cannot be
checked for approximate propriety. This is currently unavailable in
this package.
</p>
<p>To check the propriety of the joint posterior distribution, the only
argument to be supplied is an object of class <code>demonoid</code>,
<code>laplace</code>, or <code>pmc</code>. The <code>is.proper</code> function checks
the logarithm of the marginal likelihood (see <code><a href="../../LaplacesDemon/html/LML.html">LML</a></code>) for a
finite value, and returns true when LML is finite. This indicates that
the marginal likelihood is finite for all observed <i>y</i>
in the model data set. This implies:
</p>
<p align="center"><i>integral of
  p(theta|y)p(theta)dtheta &lt; Inf</i></p>

<p>If the object is of class <code>demonoid</code> and the algorithm was
adaptive, or if the object is of class <code>laplace</code> and the
algorithm did not converge, then <code>is.proper</code> will return
<code>FALSE</code> because LML was not estimated. In this case, it is
possible for the joint posterior to be proper, but <code>is.proper</code>
will be unable to determine propriety without the estimate of LML. If
desired, the <code><a href="../../LaplacesDemon/html/LML.html">LML</a></code> may be estimated by the user, and if
its finite, then the joint posterior distribution is proper.
</p>


<h3>Value</h3>


<p>The <code>is.proper</code> function returns a logical value indicating
whether or not the univariate prior or joint posterior probability
distribution integrates to 1 within its specified limits. <code>TRUE</code>
is returned for proper univariate probability distributions.
</p>


<h3>Author(s)</h3>

<p>Byron Hall <a href="mailto:statisticat@gmail.com">statisticat@gmail.com</a></p>


<h3>References</h3>

<p><a href="http://www.statisticat.com/laplacesdemon.html">http://www.statisticat.com/laplacesdemon.html</a></p>


<h3>See Also</h3>


<p><code><a href="../../LaplacesDemon/html/dnormv.html">dnormv</a></code>,
<code><a href="../../LaplacesDemon/html/integrate.html">integrate</a></code>,
<code><a href="../../LaplacesDemon/html/LaplaceApproximation.html">LaplaceApproximation</a></code>,
<code><a href="../../LaplacesDemon/html/LaplacesDemon.html">LaplacesDemon</a></code>,
<code><a href="../../LaplacesDemon/html/LML.html">LML</a></code>, and
<code><a href="../../LaplacesDemon/html/PMC.html">PMC</a></code>.
</p>


<h3>Examples</h3>

<pre>
### Prior Probability Distribution
is.proper(function(x) {dnormv(x,0,1000)}, -Inf, Inf) #x ~ N(0,1000)
is.proper(function(x) {dhalfcauchy(x,25)}, 0, Inf) #x ~ HC(25)
is.proper(function(x) {dunif(x,0,1)}, 0, 1) #x ~ U(0,1)
is.proper(function(x) {dunif(x,-Inf,Inf)}, -Inf, Inf) #x ~ U(-Inf,Inf)
### Joint Posterior Distribution
#This assumes that Fit is an object of class demonoid, laplace, or pmc
#is.proper(Fit)
</pre>

<hr><div align="center">[Package <em>LaplacesDemon</em> version 12.08.06 <a href="00Index.html">Index</a>]</div>
</body></html>