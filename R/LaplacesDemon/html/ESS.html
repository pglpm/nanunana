<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Effective Sample Size due to Autocorrelation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">
</head><body>

<table width="100%" summary="page for ESS {LaplacesDemon}"><tr><td>ESS {LaplacesDemon}</td><td align="right">R Documentation</td></tr></table>

<h2>Effective Sample Size due to Autocorrelation</h2>

<h3>Description</h3>


<p>This function may be used to estimate the effective sample size (ESS)
of a target distribution, where the sample size is reduced by
autocorrelation. ESS is a measure of how well the chains are mixing.
</p>
<p>ESS is a univariate function that is often applied to each marginal
posterior distribution. A multivariate form is not included. By chance
alone due to multiple independent tests, 5% of the parameters may
indicate that ESS is below a user threshold of acceptability, such as
100, even when above the threshold. Assessing convergence is difficult.
</p>


<h3>Usage</h3>

<pre>ESS(x)</pre>


<h3>Arguments</h3>


<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>This required argument is a vector or matrix of posterior
samples.</p>
</td></tr>
</table>


<h3>Details</h3>


<p>Effective Sample Size (ESS) was recommended by Radford Neal in the
panel discussion of Kass et al. (1998). When the posterior
distribution is sampled with a Markov chain Monte Carlo (MCMC)
algorithm, there is usually autocorrelation present in the
samples. More autocorrelation is associated with less posterior
sampled information, because the information in the samples is
autocorrelated, or put another way, successive samples are not
independent from earlier samples. This reduces the effective sample
size of, and precision in representing, the posterior
distribution. <code>ESS</code> is one of the criteria in the
<code><a href="../../LaplacesDemon/html/Consort.html">Consort</a></code> function, where stopping the MCMC updates is
not recommended until <code>ESS</code> <i>&ge; 100</i>. Although the need
for precision of each modeler differs with each model, it is often
a good goal to obtain <code>ESS</code> <i>= 1000</i>.
</p>
<p><code>ESS</code> is related to the integrated autocorrelation time (see
<code><a href="../../LaplacesDemon/html/IAT.html">IAT</a></code> for more information).
</p>
<p>ESS is usually defined as
</p>
<p align="center"><i>ESS(theta) = S / (1 + 2 sum[k] rho[k] (theta)),</i></p>

<p>where <i>S</i> is the number of posterior samples,
<i>rho[k]</i> is the autocorrelation at lag <i>k</i>, and
<i>theta</i> is the vector of marginal posterior samples. The
infinite sum is often truncated at lag <i>k</i> when
<i>rho[k](theta) &lt; 0.05</i>. Just as with the
<code>effectiveSize</code> function in the <code>coda</code> package, the
<code>AIC</code> argument in the <code>ar</code> function is used to estimate the
order.
</p>
<p>This is numerically the same as the <code>effectiveSize</code> function in
the <code>coda</code> package, but programmed to accept a simple vector or
matrix so it does not require an <code>mcmc</code> or <code>mcmc.list</code>
object, and the result is bound to be less than or equal to the
original number of samples.
</p>


<h3>Value</h3>


<p>A vector is returned, and each element is the effective sample size
(ESS) for a corresponding column of <code>x</code>, after autocorrelation has
been taken into account.
</p>


<h3>References</h3>


<p>Hall, B. (2012). &quot;Laplace's Demon&quot;, STATISTICAT, LLC.
URL=<a href="http://www.statisticat.com/laplacesdemon.html">http://www.statisticat.com/laplacesdemon.html</a>
</p>
<p>Kass, R.E., Carlin, B.P., Gelman, A., and Neal, R. (1998). &quot;Markov
Chain Monte Carlo in Practice: A Roundtable Discussion&quot;. The American
Statistician, 52, p. 93&ndash;100. 
</p>


<h3>See Also</h3>


<p><code><a href="../../LaplacesDemon/html/Consort.html">Consort</a></code>,
<code><a href="../../LaplacesDemon/html/IAT.html">IAT</a></code>,
<code><a href="../../LaplacesDemon/html/LaplacesDemon.html">LaplacesDemon</a></code>.
</p>

<hr><div align="center">[Package <em>LaplacesDemon</em> version 12.08.06 <a href="00Index.html">Index</a>]</div>
</body></html>