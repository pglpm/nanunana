(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     70384,       1884]
NotebookOptionsPosition[     63532,       1714]
NotebookOutlinePosition[     63874,       1729]
CellTagsIndexPosition[     63831,       1726]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"NS", "[", "\"\<schizo_testresults_beta3\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7085838200096407`*^9, 3.708583829903207*^9}, {
   3.7086763621327567`*^9, 3.708676364472761*^9}, {3.710231705438616*^9, 
   3.7102317111684985`*^9}, {3.7105248708166776`*^9, 3.710524876716015*^9}, {
   3.710609770746829*^9, 3.7106097759821286`*^9}, {3.710668095938897*^9, 
   3.710668103916353*^9}, 
   3.710668154685257*^9},ExpressionUUID->"e74e1d84-53fd-438e-8f5f-\
79f66fc787a7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<C:\\\\Users\\\\pglpm\\\\repositories\\\\nanunana\\\\data_schizo170727\>\
\"", "]"}]], "Input",
 CellChangeTimes->{
  3.7078048202780004`*^9, {3.7078052512826524`*^9, 3.7078053019828863`*^9}, 
   3.707889038466436*^9, {3.7083674902970743`*^9, 3.708367493860278*^9}, {
   3.708372502312461*^9, 3.708372506742715*^9}, {3.710231731448534*^9, 
   3.710231733572151*^9}},ExpressionUUID->"1f8eeb65-a040-491e-a1eb-\
38c907b68f39"],

Cell[BoxData["\<\"C:\\\\Users\\\\pglpm\\\\repositories\\\\nanunana\\\\data_\
schizo170727\"\>"], "Output",
 CellChangeTimes->{3.710524998231965*^9, 3.710526382925165*^9, 
  3.7105269355647745`*^9, 3.7105291642702494`*^9, 3.710529208855799*^9, 
  3.710533520699688*^9, 3.710533973195681*^9, 3.710581970188345*^9, 
  3.7106097824955015`*^9, 3.710664616630892*^9, 3.710668160011562*^9, 
  3.7106685138538003`*^9},ExpressionUUID->"3e856546-6c11-4af1-ab97-\
e92c1270242b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"select", " ", "only", " ", "quantities", " ", "bounded", " ", 
    RowBox[{"in", " ", "[", 
     RowBox[{"0", ",", "1"}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"selectedq", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "5"}], "}"}], "+", "ii"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "6", ",", "12", ",", "18"}], "}"}]}], "}"}]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fileselect", "=", "\"\<3\>\""}], ";"}], " ", 
   RowBox[{"(*", " ", "\"\<reduced\>\"", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"categories", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<healthy\>\"", ",", "\"\<schizo\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"categoryfiles", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<data_con\>\"", "<>", "fileselect"}], ",", 
       RowBox[{"\"\<data_schizo\>\"", "<>", "fileselect"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numcategories", "=", 
     RowBox[{"Length", "[", "categories", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"origquantities", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Import", "[", 
         RowBox[{"\"\<data_params\>\"", ",", "\"\<CSV\>\""}], "]"}]}], ")"}], 
      "[", 
      RowBox[{"[", "selectedq", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"orignumquantities", "=", 
     RowBox[{"Length", "@", "origquantities"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"tempdata", "=", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"categoryfiles", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], ",", "\"\<CSV\>\""}], "]"}], "[", 
         RowBox[{"[", "selectedq", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"jm", "=", 
        RowBox[{
         RowBox[{"Length", "[", "selectedq", "]"}], "/", "4"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "transform", " ", "2", "nd", " ", "moments", " ", "to", " ", "raw", 
         " ", "ones"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tempdata", "[", 
           RowBox[{"[", "jj", "]"}], "]"}], "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"tempdata", "[", 
             RowBox[{"[", "jj", "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"tempdata", "[", 
              RowBox[{"[", 
               RowBox[{"jj", "-", "jm"}], "]"}], "]"}], "^", "2"}]}], "]"}]}],
          ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", 
           RowBox[{"jm", "+", "1"}], ",", 
           RowBox[{"2", "*", "jm"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "transform", " ", "3", "nd", " ", "moments", " ", "to", " ", "raw", 
         " ", "ones"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tempdata", "[", 
           RowBox[{"[", "jj", "]"}], "]"}], "=", 
          RowBox[{"CubeRoot", "[", 
           RowBox[{
            RowBox[{"tempdata", "[", 
             RowBox[{"[", "jj", "]"}], "]"}], "+", 
            RowBox[{"3", "*", 
             RowBox[{
              RowBox[{"tempdata", "[", 
               RowBox[{"[", 
                RowBox[{"jj", "-", "jm"}], "]"}], "]"}], "^", "2"}], "*", 
             RowBox[{"tempdata", "[", 
              RowBox[{"[", 
               RowBox[{"jj", "-", 
                RowBox[{"2", "*", "jm"}]}], "]"}], "]"}]}], "-", 
            RowBox[{"2", "*", 
             RowBox[{
              RowBox[{"tempdata", "[", 
               RowBox[{"[", 
                RowBox[{"jj", "-", 
                 RowBox[{"2", "*", "jm"}]}], "]"}], "]"}], "^", "3"}]}]}], 
           "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", 
           RowBox[{
            RowBox[{"2", "*", "jm"}], "+", "1"}], ",", 
           RowBox[{"3", "*", "jm"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "transform", " ", "4", "nd", " ", "moments", " ", "to", " ", "raw", 
         " ", "ones"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tempdata", "[", 
           RowBox[{"[", "jj", "]"}], "]"}], "=", 
          RowBox[{"Surd", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"tempdata", "[", 
              RowBox[{"[", "jj", "]"}], "]"}], "+", 
             RowBox[{"4", "*", 
              RowBox[{
               RowBox[{"tempdata", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", "-", "jm"}], "]"}], "]"}], "^", "3"}], "*", 
              RowBox[{"tempdata", "[", 
               RowBox[{"[", 
                RowBox[{"jj", "-", 
                 RowBox[{"3", "*", "jm"}]}], "]"}], "]"}]}], "-", 
             RowBox[{"6", "*", 
              RowBox[{
               RowBox[{"tempdata", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", "-", 
                  RowBox[{"2", "*", "jm"}]}], "]"}], "]"}], "^", "2"}], "*", 
              RowBox[{
               RowBox[{"tempdata", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", "-", 
                  RowBox[{"3", "*", "jm"}]}], "]"}], "]"}], "^", "2"}]}], "+", 
             RowBox[{"3", "*", 
              RowBox[{
               RowBox[{"tempdata", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", "-", 
                  RowBox[{"3", "*", "jm"}]}], "]"}], "]"}], "^", "4"}]}]}], 
            ",", "4"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", 
           RowBox[{
            RowBox[{"3", "*", "jm"}], "+", "1"}], ",", 
           RowBox[{"4", "*", "jm"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"origsubjectfile", "[", "ii", "]"}], "=", 
        RowBox[{"N", "@", "tempdata"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"numindividuals", "[", "ii", "]"}], "=", 
        RowBox[{"Length", "[", 
         RowBox[{
          RowBox[{"origsubjectfile", "[", "ii", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "numcategories"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"one", " ", "row", " ", "for", " ", "each", " ", "quantity"}], 
     ",", " ", 
     RowBox[{
     "one", " ", "column", " ", "for", " ", "each", " ", "individual"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"minnumindividuals", "=", 
     RowBox[{"Min", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"numindividuals", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "numcategories"}], "}"}]}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAWIQfSR2UaHwgteOORqitSDaJ/lnH4h2VGxfB6Jb3jhe
BNFvLjaB6Zwy5+sgOrJU/Q6ITlNZxygKpBXmejGD6D1tZw1kgfSVz1xGIJrj
vZ0TiK5Tr/EF0VaZ56LVFr527JskmQKiLUr4+9WBtKJvP5ieErHsiAaQVqji
PQuiz4VsCtQE0gcf3QXTDHfenXcC0tMOGF4A0cddQq+BaLUso+sg+ol4+otA
IF3zuPgNiL59NuFYP5D2OxB2FUQfWBo2Z8uS1473WyyWg+i42smWx4H0naXW
CSA6oNInH0RXfA8A00I+brudlwLtExTYA6K/veD85A6kN9xRB9NXuL5regDp
G01cWiB6Mrf9vHggfVLh1UoQvcqjex2I/jMleyOY3xBlkAukNX4vswPR/ixF
ziB6S1xVCIjeIHkiEkRL/OeIAtEH7INM84B0ipScBYj2an25vhNIl234AqYB
JWPmVQ==
  "],ExpressionUUID->"c6aaa433-c6f9-4d1b-8454-e334098dee90"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"aa", "<", "bb"}], ",", 
      RowBox[{
       RowBox[{"plot", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"T", "@", 
             RowBox[{
              RowBox[{"origsubjectfile", "[", "ii", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"aa", ",", "bb"}], "}"}], ",", ";;"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "numcategories"}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], 
          RowBox[{"(*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "All"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "All"}], "}"}]}], "}"}], "*)"}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<*\>\"", ",", "Bold"}], "]"}], ",", "10"}], "}"}],
              ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<o\>\"", ",", "Bold"}], "]"}], ",", "10"}], 
              "}"}]}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"origquantities", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"aa", ",", "bb"}], "}"}], "]"}], "]"}]}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"expng", "[", 
        RowBox[{
         RowBox[{"\"\<visualize_data5\\\\expldata-\>\"", "<>", 
          RowBox[{"ToString", "[", "aa", "]"}], "<>", "\"\<_\>\"", "<>", 
          RowBox[{"ToString", "[", "bb", "]"}]}], ",", "plot"}], "]"}], ";"}],
       ",", "Null"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"aa", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "10", ",", "16", ",", "22"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"bb", ",", "24"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.710533563740164*^9, 3.7105335852838016`*^9}, {
  3.710582276507866*^9, 3.7105823154580936`*^9}, {3.710582348337974*^9, 
  3.710582399331891*^9}, {3.710582441257289*^9, 3.7105824544610443`*^9}, {
  3.710582500640685*^9, 3.7105825140724535`*^9}, {3.7105826205265427`*^9, 
  3.710582632666237*^9}},ExpressionUUID->"2f02cc0d-748d-416f-a7fc-\
ff2a27984716"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"analysis", " ", "with", " ", "beta", " ", "distribution"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.710610171025214*^9, 
  3.710610180993632*^9}},ExpressionUUID->"72477d72-72a1-4d79-9306-\
728b01167edf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"beta", "[", 
   RowBox[{"s_", ",", "a_", ",", "b_"}], "]"}], "=", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{"0", "<", "s", "<", "1"}], ",", 
    RowBox[{"FS", "@", 
     RowBox[{"PDF", "[", 
      RowBox[{
       RowBox[{"BetaDistribution", "[", 
        RowBox[{"a", ",", "b"}], "]"}], ",", "s"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.710582902597676*^9, 3.7105829363466063`*^9}, {
  3.7106102098380823`*^9, 
  3.710610210243683*^9}},ExpressionUUID->"d5979a45-6609-4bc9-b629-\
2a0e641ccd40"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", "s"}], ")"}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", "b"}]], " ", 
   SuperscriptBox["s", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "a"}]]}], 
  RowBox[{"Beta", "[", 
   RowBox[{"a", ",", "b"}], "]"}]]], "Output",
 CellChangeTimes->{{3.710582931654338*^9, 3.710582936875636*^9}, 
   3.710610211741286*^9, 3.7106646490047436`*^9, 3.710668166347924*^9, 
   3.7106685208181987`*^9},ExpressionUUID->"96dfa114-edaa-45c1-8218-\
b85487756a9a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"pparam", "[", 
   RowBox[{"datum_", ",", "a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a", "-", "1"}], ")"}], "*", 
    RowBox[{"Total", "[", 
     RowBox[{"Log", "[", "datum", "]"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"b", "-", "1"}], ")"}], "*", 
    RowBox[{"Total", "[", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "-", "datum"}], "]"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"Length", "[", "datum", "]"}], "*", 
    RowBox[{"Log", "[", 
     RowBox[{"Beta", "[", 
      RowBox[{"a", ",", "b"}], "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.710610324614153*^9, 3.710610420139447*^9}, {
  3.7106115306024637`*^9, 3.7106115308832645`*^9}, {3.710611565562125*^9, 
  3.7106116300994387`*^9}},ExpressionUUID->"527ec65d-51e7-4123-ba80-\
8da25ce6354f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "we", " ", "approximate", " ", "posterior", " ", "by", " ", "the", " ", 
     "maximum"}], "-", 
    RowBox[{"likelihood", " ", "distribution"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "fun", "]"}], ";", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"maxx", "[", "ii", "]"}], "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"fun", "=", 
           RowBox[{"pparam", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"origsubjectfile", "[", "ii", "]"}], "[", 
              RowBox[{"[", "jj", "]"}], "]"}], ",", "a", ",", "b"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], "/.", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"NMaximize", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"fun", ",", 
                 RowBox[{
                  RowBox[{"a", ">=", "0"}], "&&", 
                  RowBox[{"b", ">=", "0"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "orignumquantities"}], "}"}]}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "numcategories"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7106109587054596`*^9, 3.7106111296193595`*^9}, {
  3.71061119244067*^9, 3.7106113402821293`*^9}, {3.7106114114806547`*^9, 
  3.7106114621807437`*^9}, {3.7106114934743986`*^9, 3.7106114982168074`*^9}, {
  3.710611695167153*^9, 
  3.710611728379611*^9}},ExpressionUUID->"79a2b523-0028-42dc-86ea-\
e164b92d2a4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"logpred", "[", 
   RowBox[{"cat_", ",", "datum_"}], "]"}], ":=", 
  RowBox[{"Total", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Log", "@", 
      RowBox[{"beta", "[", 
       RowBox[{
        RowBox[{"datum", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"maxx", "[", "cat", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"ii", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"maxx", "[", "cat", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"ii", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "orignumquantities"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.710611963862025*^9, 
  3.710612102967469*^9}},ExpressionUUID->"8c48fab1-90da-4b07-baea-\
60a252fdf4ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Exp", "@", 
  RowBox[{"logpred", "[", 
   RowBox[{"1", ",", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"origsubjectfile", "[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.710612106196675*^9, 3.710612160937171*^9}, {
  3.710612219499674*^9, 
  3.7106122277364883`*^9}},ExpressionUUID->"b4b76bc4-37e4-4388-a8af-\
4d5df0f40c81"],

Cell[BoxData["699857.394518673`"], "Output",
 CellChangeTimes->{
  3.710612163776376*^9, {3.7106122208568764`*^9, 3.7106122282824893`*^9}, 
   3.7106646637695885`*^9, 3.7106681884351873`*^9, 
   3.7106685245514126`*^9},ExpressionUUID->"e946676c-f0e6-47e1-81f6-\
cce806b569b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Exp", "@", 
  RowBox[{"logpred", "[", 
   RowBox[{"1", ",", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"origsubjectfile", "[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7106121745247946`*^9, 
  3.7106122054908495`*^9}},ExpressionUUID->"83287d2d-6d5f-499f-9f09-\
aaa13f55365f"],

Cell[BoxData["296394.9021807101`"], "Output",
 CellChangeTimes->{3.7106122059120502`*^9, 3.710664665411682*^9, 
  3.710668189251234*^9, 
  3.7106685254004607`*^9},ExpressionUUID->"c696c4d2-8448-478b-abdc-\
844eb17d731b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"pred1", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Normalize", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Exp", "@", 
            RowBox[{"logpred", "[", 
             RowBox[{"ii", ",", 
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"origsubjectfile", "[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "numcategories"}], "}"}]}], "]"}], ",", 
         "Total"}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jj", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"T", "[", 
           RowBox[{"origsubjectfile", "[", "1", "]"}], "]"}], "]"}]}], 
        "}"}]}], "]"}]}], ")"}], "*", "100"}], "//", "MF"}]], "Input",
 CellChangeTimes->{{3.710612258187742*^9, 3.710612396263584*^9}, {
  3.71061245632369*^9, 3.7106124753089232`*^9}, {3.71066497885061*^9, 
  3.710664981239746*^9}},ExpressionUUID->"4b399ba8-f27c-407a-9d3f-\
0ea103923259"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"28.410574311401472`", "71.58942568859854`"},
     {"14.375556776179996`", "85.62444322382`"},
     {"89.36788604902942`", "10.63211395097058`"},
     {"55.21957842038751`", "44.78042157961248`"},
     {"88.97203603239385`", "11.02796396760616`"},
     {"79.98640274757197`", "20.01359725242801`"},
     {"55.16941940112849`", "44.8305805988715`"},
     {"29.47698732816463`", "70.52301267183537`"},
     {"27.59960732536395`", "72.40039267463607`"},
     {"85.39236724093084`", "14.60763275906915`"},
     {"9.242283671551144`", "90.75771632844885`"},
     {"33.28902000616887`", "66.71097999383112`"},
     {"52.98641056627652`", "47.01358943372347`"},
     {"85.76131874712367`", "14.238681252876342`"},
     {"87.40701010783118`", "12.59298989216881`"},
     {"87.43386425117235`", "12.566135748827644`"},
     {"85.02348651196345`", "14.976513488036556`"},
     {"80.18129437436914`", "19.818705625630848`"},
     {"77.95336842932528`", "22.046631570674702`"},
     {"62.29700002543689`", "37.70299997456311`"},
     {"85.12499596023795`", "14.875004039762036`"},
     {"89.40130693376686`", "10.59869306623313`"},
     {"48.70262366978608`", "51.297376330213936`"},
     {"0.9205701638082199`", "99.07942983619176`"},
     {"79.26061816050284`", "20.73938183949716`"},
     {"25.650515039946477`", "74.34948496005353`"},
     {"35.91708428284868`", "64.08291571715132`"},
     {"80.0740643440958`", "19.92593565590421`"},
     {"0.024062500382531122`", "99.97593749961746`"},
     {"4.243305777543708`", "95.7566942224563`"},
     {"45.18406512992856`", "54.81593487007144`"},
     {"87.61605853481637`", "12.383941465183625`"},
     {"88.87735646061496`", "11.122643539385045`"},
     {"68.7221199283674`", "31.277880071632598`"},
     {"86.04186914612448`", "13.958130853875522`"},
     {"67.38732326235505`", "32.61267673764496`"},
     {"87.52180753721399`", "12.478192462786012`"},
     {"62.15534806312159`", "37.8446519368784`"},
     {"55.859589415208745`", "44.140410584791255`"},
     {"89.04268541310095`", "10.957314586899042`"},
     {"57.89596017046132`", "42.10403982953868`"},
     {"35.533153594724666`", "64.46684640527533`"},
     {"6.544474380036047`", "93.45552561996395`"},
     {"86.24442904330517`", "13.755570956694838`"},
     {"89.0032666723618`", "10.996733327638195`"},
     {"79.66806098383904`", "20.33193901616096`"},
     {"23.953385556503033`", "76.04661444349698`"},
     {"88.42122664985745`", "11.578773350142557`"},
     {"75.59775983959119`", "24.402240160408812`"},
     {"37.744334368705495`", "62.2556656312945`"},
     {"11.588461318418629`", "88.41153868158138`"},
     {"70.67853562177649`", "29.32146437822352`"},
     {"88.12076921278023`", "11.879230787219761`"},
     {"82.42744803078736`", "17.57255196921264`"},
     {"20.10431333932145`", "79.89568666067855`"},
     {"88.16683294300614`", "11.833167056993855`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7106123797899556`*^9, 3.710612396575585*^9}, 
   3.710612475808124*^9, 3.710664668908882*^9, 3.710664981793778*^9, 
   3.7106681916763725`*^9, 
   3.7106685272625675`*^9},ExpressionUUID->"d53f3fa8-1783-448a-b526-\
d278583367bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mean", "[", "pred1", "]"}]], "Input",
 CellChangeTimes->{{3.710612477602127*^9, 
  3.710612480222932*^9}},ExpressionUUID->"b18c99a7-6590-43a5-b30f-\
0e1cf7937003"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.5973152238880388`", ",", "0.4026847761119612`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7106124805505323`*^9, 3.710664673362137*^9, 
  3.710664985964017*^9, 3.7106681949405594`*^9, 
  3.7106685295606985`*^9},ExpressionUUID->"fff11976-3b05-4f8a-99e5-\
cc9577473855"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"pred2", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Normalize", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Exp", "@", 
            RowBox[{"logpred", "[", 
             RowBox[{"ii", ",", 
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"origsubjectfile", "[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "numcategories"}], "}"}]}], "]"}], ",", 
         "Total"}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jj", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"T", "[", 
           RowBox[{"origsubjectfile", "[", "2", "]"}], "]"}], "]"}]}], 
        "}"}]}], "]"}]}], ")"}], "*", "100"}], "//", "MF"}]], "Input",
 CellChangeTimes->{{3.7106124249988346`*^9, 3.710612427448039*^9}, {
  3.7106124849497404`*^9, 3.7106124912365513`*^9}, {3.7106649905412784`*^9, 
  3.710664992178372*^9}},ExpressionUUID->"a4cc623e-14f3-4063-baba-\
515afb3d0066"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"45.798615735047896`", "54.201384264952104`"},
     {"1.2026212099742217`", "98.79737879002577`"},
     {"20.709343820772585`", "79.29065617922741`"},
     {"72.588428290907`", "27.411571709092993`"},
     {"2.435208034094992`", "97.56479196590502`"},
     {"1.9487653689602147`", "98.05123463103979`"},
     {"42.611248498072015`", "57.38875150192797`"},
     {"58.91652794404458`", "41.083472055955426`"},
     {"84.50088562278462`", "15.499114377215381`"},
     {"2.8697124824693048`", "97.13028751753072`"},
     {"62.72315804350623`", "37.27684195649377`"},
     {"81.88963392943677`", "18.11036607056323`"},
     {"89.30089280862414`", "10.699107191375855`"},
     {"89.56881152070459`", "10.43118847929542`"},
     {"6.416215790698463`", "93.58378420930153`"},
     {"9.908995945058523`", "90.09100405494146`"},
     {"63.1905607495752`", "36.809439250424816`"},
     {"0.4796405498875283`", "99.52035945011247`"},
     {"86.33722212404717`", "13.662777875952825`"},
     {"88.20320467570892`", "11.796795324291088`"},
     {"86.4629156925015`", "13.537084307498512`"},
     {"8.863955689285657`", "91.13604431071434`"},
     {"71.94580430905269`", "28.05419569094731`"},
     {"29.106247600544993`", "70.89375239945501`"},
     {"87.10729955792145`", "12.892700442078564`"},
     {"56.8275461718918`", "43.17245382810819`"},
     {"63.499585097512266`", "36.50041490248772`"},
     {"25.917498731634875`", "74.08250126836514`"},
     {"35.41891200480348`", "64.58108799519651`"},
     {"16.387524153705794`", "83.61247584629422`"},
     {"89.3767873860979`", "10.623212613902108`"},
     {"0.8501203689441562`", "99.14987963105585`"},
     {"79.6346747231305`", "20.365325276869484`"},
     {"4.26632279091788`", "95.73367720908212`"},
     {"8.249528081295482`", "91.75047191870452`"},
     {"1.8112676674301214`", "98.18873233256988`"},
     {"88.36873641707484`", "11.631263582925165`"},
     {"71.98495890157758`", "28.015041098422405`"},
     {"81.495570572679`", "18.504429427320993`"},
     {"12.519792341229483`", "87.48020765877051`"},
     {"74.46311453788019`", "25.536885462119795`"},
     {"70.55921914535786`", "29.440780854642135`"},
     {"66.02770067853727`", "33.972299321462735`"},
     {"7.122190603836749`", "92.87780939616326`"},
     {"87.84099714934557`", "12.159002850654426`"},
     {"78.81082693822528`", "21.189173061774728`"},
     {"66.43431537324376`", "33.565684626756244`"},
     {"28.886126362724447`", "71.11387363727555`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7106124279784403`*^9, 3.710612492188153*^9, 
  3.710664674379195*^9, 3.7106649925613937`*^9, 3.710668197484705*^9, 
  3.7106685310067816`*^9},ExpressionUUID->"8e94d3de-00ea-40e5-ace6-\
dc2eefd0faa4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"correct", "[", "a_", "]"}], "=", 
  RowBox[{"Boole", "[", 
   RowBox[{"a", ">", "0.5"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.710664707896112*^9, 
  3.710664753614727*^9}},ExpressionUUID->"4c689dc1-0a57-4de6-9a90-\
b0fed0fe6019"],

Cell[BoxData[
 RowBox[{"Boole", "[", 
  RowBox[{"a", ">", "0.5`"}], "]"}]], "Output",
 CellChangeTimes->{3.710664760103098*^9, 3.7106682002388625`*^9, 
  3.7106685337509384`*^9},ExpressionUUID->"caaa9873-7023-48d5-902a-\
75b6aad7e161"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"spred1", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"correct", ",", "pred1", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
  RowBox[{"spred2", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"correct", ",", "pred2", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.710664780484264*^9, 3.7106647840534678`*^9}, {
  3.7106648175243826`*^9, 3.7106648979559827`*^9}, {3.710664958672456*^9, 
  3.710664966008875*^9}, {3.710665004783093*^9, 
  3.7106650184778767`*^9}},ExpressionUUID->"c867156b-671f-445d-a5c5-\
4a95fd72adff"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Total", "[", "spred1", "]"}], ",", 
   RowBox[{"Total", "[", "spred2", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.7106650212810364`*^9, 
  3.710665033476734*^9}},ExpressionUUID->"40a7d8a0-e7c1-49c5-b78c-\
820998d6c5a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"37", ",", "19"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"26", ",", "22"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.710665033806753*^9, 3.7106682037990665`*^9, 
  3.7106685357580533`*^9},ExpressionUUID->"83f04dd2-fb9f-4a85-a09c-\
725eaaa0cf66"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Mean", "[", "pred1", "]"}], ",", 
   RowBox[{"Mean", "[", "pred2", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.7106650440593395`*^9, 
  3.7106650575051084`*^9}},ExpressionUUID->"762f020d-f465-4c3e-bdf4-\
6b4458709c82"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.5973152238880388`", ",", "0.4026847761119612`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.48163317337349104`", ",", "0.518366826626509`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7106650578541284`*^9, 3.7106682055531664`*^9, 
  3.710668536629103*^9},ExpressionUUID->"2e60e6af-2a23-4bad-b79e-\
0d245bbc00a4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Now", " ", "using", " ", "graphweights1", " ", "only"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.710665099345502*^9, 
  3.710665109645091*^9}},ExpressionUUID->"a130a600-5850-4b13-9ef3-\
b87153ba7c7a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"select", " ", "only", " ", "quantities", " ", "bounded", " ", 
    RowBox[{"in", " ", "[", 
     RowBox[{"0", ",", "1"}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"selectedq", "=", 
     RowBox[{"{", "1", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fileselect", "=", "\"\<3\>\""}], ";", " ", 
    RowBox[{"(*", " ", "\"\<reduced\>\"", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"categories", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<healthy\>\"", ",", "\"\<schizo\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"categoryfiles", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<data_con\>\"", "<>", "fileselect"}], ",", 
       RowBox[{"\"\<data_schizo\>\"", "<>", "fileselect"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numcategories", "=", 
     RowBox[{"Length", "[", "categories", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"origquantities", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Import", "[", 
         RowBox[{"\"\<data_params\>\"", ",", "\"\<CSV\>\""}], "]"}]}], ")"}], 
      "[", 
      RowBox[{"[", "selectedq", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"orignumquantities", "=", 
     RowBox[{"Length", "@", "origquantities"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"tempdata", "=", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"categoryfiles", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], ",", "\"\<CSV\>\""}], "]"}], "[", 
         RowBox[{"[", "selectedq", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"jm", "=", 
          RowBox[{
           RowBox[{"Length", "[", "selectedq", "]"}], "/", "4"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "transform", " ", "2", "nd", " ", "moments", " ", "to", " ", "raw", 
           " ", "ones"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tempdata", "[", 
             RowBox[{"[", "jj", "]"}], "]"}], "=", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"tempdata", "[", 
               RowBox[{"[", "jj", "]"}], "]"}], "+", 
              RowBox[{
               RowBox[{"tempdata", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", "-", "jm"}], "]"}], "]"}], "^", "2"}]}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"jj", ",", 
             RowBox[{"jm", "+", "1"}], ",", 
             RowBox[{"2", "*", "jm"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "transform", " ", "3", "nd", " ", "moments", " ", "to", " ", "raw", 
           " ", "ones"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tempdata", "[", 
             RowBox[{"[", "jj", "]"}], "]"}], "=", 
            RowBox[{"CubeRoot", "[", 
             RowBox[{
              RowBox[{"tempdata", "[", 
               RowBox[{"[", "jj", "]"}], "]"}], "+", 
              RowBox[{"3", "*", 
               RowBox[{
                RowBox[{"tempdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"jj", "-", "jm"}], "]"}], "]"}], "^", "2"}], "*", 
               RowBox[{"tempdata", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", "-", 
                  RowBox[{"2", "*", "jm"}]}], "]"}], "]"}]}], "-", 
              RowBox[{"2", "*", 
               RowBox[{
                RowBox[{"tempdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"jj", "-", 
                   RowBox[{"2", "*", "jm"}]}], "]"}], "]"}], "^", "3"}]}]}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"jj", ",", 
             RowBox[{
              RowBox[{"2", "*", "jm"}], "+", "1"}], ",", 
             RowBox[{"3", "*", "jm"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "transform", " ", "4", "nd", " ", "moments", " ", "to", " ", "raw", 
           " ", "ones"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tempdata", "[", 
             RowBox[{"[", "jj", "]"}], "]"}], "=", 
            RowBox[{"Surd", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"tempdata", "[", 
                RowBox[{"[", "jj", "]"}], "]"}], "+", 
               RowBox[{"4", "*", 
                RowBox[{
                 RowBox[{"tempdata", "[", 
                  RowBox[{"[", 
                   RowBox[{"jj", "-", "jm"}], "]"}], "]"}], "^", "3"}], "*", 
                RowBox[{"tempdata", "[", 
                 RowBox[{"[", 
                  RowBox[{"jj", "-", 
                   RowBox[{"3", "*", "jm"}]}], "]"}], "]"}]}], "-", 
               RowBox[{"6", "*", 
                RowBox[{
                 RowBox[{"tempdata", "[", 
                  RowBox[{"[", 
                   RowBox[{"jj", "-", 
                    RowBox[{"2", "*", "jm"}]}], "]"}], "]"}], "^", "2"}], "*", 
                RowBox[{
                 RowBox[{"tempdata", "[", 
                  RowBox[{"[", 
                   RowBox[{"jj", "-", 
                    RowBox[{"3", "*", "jm"}]}], "]"}], "]"}], "^", "2"}]}], 
               "+", 
               RowBox[{"3", "*", 
                RowBox[{
                 RowBox[{"tempdata", "[", 
                  RowBox[{"[", 
                   RowBox[{"jj", "-", 
                    RowBox[{"3", "*", "jm"}]}], "]"}], "]"}], "^", "4"}]}]}], 
              ",", "4"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"jj", ",", 
             RowBox[{
              RowBox[{"3", "*", "jm"}], "+", "1"}], ",", 
             RowBox[{"4", "*", "jm"}]}], "}"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"origsubjectfile", "[", "ii", "]"}], "=", 
        RowBox[{"N", "@", "tempdata"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"numindividuals", "[", "ii", "]"}], "=", 
        RowBox[{"Length", "[", 
         RowBox[{
          RowBox[{"origsubjectfile", "[", "ii", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "numcategories"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"one", " ", "row", " ", "for", " ", "each", " ", "quantity"}], 
     ",", " ", 
     RowBox[{
     "one", " ", "column", " ", "for", " ", "each", " ", "individual"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"minnumindividuals", "=", 
     RowBox[{"Min", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"numindividuals", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "numcategories"}], "}"}]}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzVsogwEYxvE5XMwkh7XYClvJNlejZKymbxPSxrZYTJvFkONyjIUkOaS2
suUKISMuFiKFNKXhYliNKZPCxbJFUeRQvO938fTrufpzao2q+nAKhZIMQ4+1
Sx30hSDRymMMorK6LzNKcMYd6GiI8KAhzwhpa6/Uh1b1cP1oQ5ojjAGy50oi
0IMxtyAZ9L7TslDqq1iCDnEH5Ghe03l1+mKQME8zDaiwO9bCBTlyC6mtcuWY
B7JNMW70vHxLyQePHu5IKf6XCwk448y8RE8KKq7R9OYsH/qU2BhQggOPXSH0
1q13WcBSp/oKddrVs9vLQeJ+VLiK6gatuSeg3y7So4p+mRHt+1SQJsgK96V2
6MXHHaAfgai3InDDzyX10j75xeDNCC0DtUbnz9eAZ+znNXS9eMqB/tpaNsk/
rBG0gbyfFTFaFtkpRbd1pnJ0g3lahSb9UTWoM1+V3Q4aWClCdOeblTMB7rqk
IlT4Rd+bBA+1qaT/usTtxQ==
  "],ExpressionUUID->"3f417bb5-acba-454a-918a-e1abc0d16546"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"aa", "<", "bb"}], ",", 
      RowBox[{
       RowBox[{"plot", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"T", "@", 
             RowBox[{
              RowBox[{"origsubjectfile", "[", "ii", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"aa", ",", "bb"}], "}"}], ",", ";;"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "numcategories"}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], 
          RowBox[{"(*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "All"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "All"}], "}"}]}], "}"}], "*)"}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<*\>\"", ",", "Bold"}], "]"}], ",", "10"}], "}"}],
              ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<o\>\"", ",", "Bold"}], "]"}], ",", "10"}], 
              "}"}]}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"origquantities", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"aa", ",", "bb"}], "}"}], "]"}], "]"}]}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"expng", "[", 
        RowBox[{
         RowBox[{"\"\<visualize_data5\\\\expldata-\>\"", "<>", 
          RowBox[{"ToString", "[", "aa", "]"}], "<>", "\"\<_\>\"", "<>", 
          RowBox[{"ToString", "[", "bb", "]"}]}], ",", "plot"}], "]"}], ";"}],
       ",", "Null"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"aa", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "10", ",", "16", ",", "22"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"bb", ",", "24"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.710533563740164*^9, 3.7105335852838016`*^9}, {
  3.710582276507866*^9, 3.7105823154580936`*^9}, {3.710582348337974*^9, 
  3.710582399331891*^9}, {3.710582441257289*^9, 3.7105824544610443`*^9}, {
  3.710582500640685*^9, 3.7105825140724535`*^9}, {3.7105826205265427`*^9, 
  3.710582632666237*^9}},ExpressionUUID->"c6960225-1d53-4712-aecc-\
37c14d4c53e1"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"analysis", " ", "with", " ", "beta", " ", "distribution"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.710610171025214*^9, 
  3.710610180993632*^9}},ExpressionUUID->"24d4add2-e2f8-4116-ac83-\
5248f146d3ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"beta", "[", 
   RowBox[{"s_", ",", "a_", ",", "b_"}], "]"}], "=", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{"0", "<", "s", "<", "1"}], ",", 
    RowBox[{"FS", "@", 
     RowBox[{"PDF", "[", 
      RowBox[{
       RowBox[{"BetaDistribution", "[", 
        RowBox[{"a", ",", "b"}], "]"}], ",", "s"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.710582902597676*^9, 3.7105829363466063`*^9}, {
  3.7106102098380823`*^9, 
  3.710610210243683*^9}},ExpressionUUID->"a859cf1b-b954-496b-aa4a-\
31bc80e6afaa"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", "s"}], ")"}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", "b"}]], " ", 
   SuperscriptBox["s", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "a"}]]}], 
  RowBox[{"Beta", "[", 
   RowBox[{"a", ",", "b"}], "]"}]]], "Output",
 CellChangeTimes->{{3.710582931654338*^9, 3.710582936875636*^9}, 
   3.710610211741286*^9, 
   3.7106646490047436`*^9},ExpressionUUID->"81b4d6e7-114e-49a4-ad4e-\
007b89b3881f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"pparam", "[", 
   RowBox[{"datum_", ",", "a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a", "-", "1"}], ")"}], "*", 
    RowBox[{"Total", "[", 
     RowBox[{"Log", "[", "datum", "]"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"b", "-", "1"}], ")"}], "*", 
    RowBox[{"Total", "[", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "-", "datum"}], "]"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"Length", "[", "datum", "]"}], "*", 
    RowBox[{"Log", "[", 
     RowBox[{"Beta", "[", 
      RowBox[{"a", ",", "b"}], "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.710610324614153*^9, 3.710610420139447*^9}, {
  3.7106115306024637`*^9, 3.7106115308832645`*^9}, {3.710611565562125*^9, 
  3.7106116300994387`*^9}},ExpressionUUID->"d21ba48d-6945-4cb7-a651-\
1c125569fc1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "we", " ", "approximate", " ", "posterior", " ", "by", " ", "the", " ", 
     "maximum"}], "-", 
    RowBox[{"likelihood", " ", "distribution"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "fun", "]"}], ";", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"maxx", "[", "ii", "]"}], "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"fun", "=", 
           RowBox[{"pparam", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"origsubjectfile", "[", "ii", "]"}], "[", 
              RowBox[{"[", "jj", "]"}], "]"}], ",", "a", ",", "b"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], "/.", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"NMaximize", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"fun", ",", 
                 RowBox[{
                  RowBox[{"a", ">=", "0"}], "&&", 
                  RowBox[{"b", ">=", "0"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "orignumquantities"}], "}"}]}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "numcategories"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7106109587054596`*^9, 3.7106111296193595`*^9}, {
  3.71061119244067*^9, 3.7106113402821293`*^9}, {3.7106114114806547`*^9, 
  3.7106114621807437`*^9}, {3.7106114934743986`*^9, 3.7106114982168074`*^9}, {
  3.710611695167153*^9, 
  3.710611728379611*^9}},ExpressionUUID->"693ceafd-431c-4674-8a41-\
b0d1e97b8702"],

Cell[BoxData[
 RowBox[{
  RowBox[{"logpred", "[", 
   RowBox[{"cat_", ",", "datum_"}], "]"}], ":=", 
  RowBox[{"Total", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Log", "@", 
      RowBox[{"beta", "[", 
       RowBox[{
        RowBox[{"datum", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"maxx", "[", "cat", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"ii", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"maxx", "[", "cat", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"ii", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "orignumquantities"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.710611963862025*^9, 
  3.710612102967469*^9}},ExpressionUUID->"406af074-a05c-4b63-8d98-\
d44f69294638"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Exp", "@", 
  RowBox[{"logpred", "[", 
   RowBox[{"1", ",", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"origsubjectfile", "[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.710612106196675*^9, 3.710612160937171*^9}, {
  3.710612219499674*^9, 
  3.7106122277364883`*^9}},ExpressionUUID->"14f60fbc-cdf9-4a2e-b573-\
05c50077d170"],

Cell[BoxData["3.5861523152245542`"], "Output",
 CellChangeTimes->{
  3.710612163776376*^9, {3.7106122208568764`*^9, 3.7106122282824893`*^9}, 
   3.7106646637695885`*^9, 3.710665202960428*^9, {3.710668227080398*^9, 
   3.7106682491346593`*^9}},ExpressionUUID->"e15a964d-b491-4c91-9371-\
d04fc9616e24"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Exp", "@", 
  RowBox[{"logpred", "[", 
   RowBox[{"1", ",", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"origsubjectfile", "[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7106121745247946`*^9, 
  3.7106122054908495`*^9}},ExpressionUUID->"792c0821-c245-430b-b67e-\
d92e75b36260"],

Cell[BoxData["3.290950332640147`"], "Output",
 CellChangeTimes->{
  3.7106122059120502`*^9, 3.710664665411682*^9, 3.7106652037684746`*^9, {
   3.710668227981449*^9, 
   3.710668249859701*^9}},ExpressionUUID->"1276a2b0-65fb-4628-9c92-\
e4df584f32a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"pred1b", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Normalize", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Exp", "@", 
            RowBox[{"logpred", "[", 
             RowBox[{"ii", ",", 
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"origsubjectfile", "[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "numcategories"}], "}"}]}], "]"}], ",", 
         "Total"}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jj", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"T", "[", 
           RowBox[{"origsubjectfile", "[", "1", "]"}], "]"}], "]"}]}], 
        "}"}]}], "]"}]}], ")"}], "*", "100"}], "//", "MF"}]], "Input",
 CellChangeTimes->{{3.710612258187742*^9, 3.710612396263584*^9}, {
   3.71061245632369*^9, 3.7106124753089232`*^9}, {3.71066497885061*^9, 
   3.710664981239746*^9}, 
   3.7106652150011168`*^9},ExpressionUUID->"76ba5088-3c3c-4b1d-9bfb-\
69c6312bf56a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"48.34843507150089`", "51.65156492849913`"},
     {"46.361372898534384`", "53.63862710146563`"},
     {"54.59423249572186`", "45.40576750427815`"},
     {"50.53866245695582`", "49.46133754304417`"},
     {"54.50647175449635`", "45.49352824550365`"},
     {"52.506249273876726`", "47.493750726123274`"},
     {"50.57601928839571`", "49.423980711604294`"},
     {"48.47623118644606`", "51.52376881355393`"},
     {"45.27213566623484`", "54.72786433376516`"},
     {"53.648635910459916`", "46.351364089540084`"},
     {"46.35293675283897`", "53.64706324716104`"},
     {"48.41988339492666`", "51.58011660507334`"},
     {"50.60490621600637`", "49.39509378399362`"},
     {"53.61322271274659`", "46.38677728725341`"},
     {"54.621844243870996`", "45.378155756129004`"},
     {"54.083254689198526`", "45.916745310801474`"},
     {"53.450553254323474`", "46.54944674567652`"},
     {"52.46860322634021`", "47.53139677365979`"},
     {"52.97366078061276`", "47.026339219387225`"},
     {"50.974934353725544`", "49.02506564627445`"},
     {"53.26403347324036`", "46.73596652675963`"},
     {"54.55411951169601`", "45.445880488304`"},
     {"49.81307066941808`", "50.18692933058191`"},
     {"41.650341815246776`", "58.34965818475322`"},
     {"52.71249426809164`", "47.287505731908375`"},
     {"48.349828963310834`", "51.650171036689166`"},
     {"49.81641042041923`", "50.183589579580755`"},
     {"52.943162848823135`", "47.056837151176865`"},
     {"36.89996880579286`", "63.10003119420714`"},
     {"38.44832824670841`", "61.55167175329159`"},
     {"49.82593271470187`", "50.17406728529813`"},
     {"54.153449754348635`", "45.84655024565138`"},
     {"54.40460800464428`", "45.59539199535572`"},
     {"50.742797192491054`", "49.25720280750895`"},
     {"53.64195054861587`", "46.35804945138413`"},
     {"52.44641084807944`", "47.55358915192057`"},
     {"54.13565580043909`", "45.86434419956091`"},
     {"51.58456434787654`", "48.41543565212345`"},
     {"50.79942892703067`", "49.200571072969346`"},
     {"54.4924553232539`", "45.507544676746086`"},
     {"51.32278295044029`", "48.67721704955971`"},
     {"48.92200867145774`", "51.07799132854225`"},
     {"45.437626280509384`", "54.56237371949061`"},
     {"53.76175744886189`", "46.23824255113811`"},
     {"54.4675501082162`", "45.53244989178379`"},
     {"52.74211258417646`", "47.25788741582354`"},
     {"44.5134766769724`", "55.486523323027605`"},
     {"54.327054221679695`", "45.672945778320326`"},
     {"53.30369211435191`", "46.696307885648096`"},
     {"49.00822211252756`", "50.99177788747243`"},
     {"45.97298853782174`", "54.027011462178244`"},
     {"50.831648216398136`", "49.16835178360184`"},
     {"54.4283431859599`", "45.5716568140401`"},
     {"53.541970236574045`", "46.458029763425955`"},
     {"47.529158070398275`", "52.47084192960173`"},
     {"54.14411933698284`", "45.85588066301716`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7106123797899556`*^9, 3.710612396575585*^9}, 
   3.710612475808124*^9, 3.710664668908882*^9, 3.710664981793778*^9, 
   3.710665217189242*^9, {3.71066823166866*^9, 
   3.7106682511087723`*^9}},ExpressionUUID->"91b72ff8-7ba6-4da0-86ab-\
95d89556a116"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mean", "[", "pred1b", "]"}]], "Input",
 CellChangeTimes->{{3.710612477602127*^9, 3.710612480222932*^9}, 
   3.710665222831565*^9},ExpressionUUID->"57341d84-dadc-4121-9171-\
6eb82d3d2321"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.5073796015829947`", ",", "0.4926203984170054`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7106124805505323`*^9, 3.710664673362137*^9, 3.710664985964017*^9, {
   3.710665220751446*^9, 3.7106652232105865`*^9}, {3.7106682334507623`*^9, 
   3.7106682525498548`*^9}},ExpressionUUID->"792c718f-cfe4-445a-8ecd-\
28142fd9d92f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"pred2b", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Normalize", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Exp", "@", 
            RowBox[{"logpred", "[", 
             RowBox[{"ii", ",", 
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"origsubjectfile", "[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "numcategories"}], "}"}]}], "]"}], ",", 
         "Total"}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jj", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"T", "[", 
           RowBox[{"origsubjectfile", "[", "2", "]"}], "]"}], "]"}]}], 
        "}"}]}], "]"}]}], ")"}], "*", "100"}], "//", "MF"}]], "Input",
 CellChangeTimes->{{3.7106124249988346`*^9, 3.710612427448039*^9}, {
   3.7106124849497404`*^9, 3.7106124912365513`*^9}, {3.7106649905412784`*^9, 
   3.710664992178372*^9}, 
   3.710665225476716*^9},ExpressionUUID->"41ba7e75-24d3-4c02-b40a-\
cfeccdecc51f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"49.612462372497276`", "50.387537627502724`"},
     {"35.47694183917163`", "64.52305816082837`"},
     {"49.1747992907488`", "50.825200709251185`"},
     {"52.03892977088144`", "47.96107022911856`"},
     {"43.2236824918577`", "56.776317508142306`"},
     {"43.47193170099175`", "56.52806829900824`"},
     {"49.740294067106596`", "50.2597059328934`"},
     {"50.03269210475386`", "49.967307895246144`"},
     {"53.53511688263073`", "46.46488311736928`"},
     {"42.93626448733016`", "57.06373551266982`"},
     {"50.29864761994236`", "49.70135238005765`"},
     {"52.83508231696503`", "47.16491768303497`"},
     {"54.56136354738099`", "45.438636452619015`"},
     {"54.595715805648226`", "45.40428419435176`"},
     {"46.419628232782216`", "53.58037176721779`"},
     {"45.52914889305259`", "54.47085110694739`"},
     {"51.15631661819483`", "48.843683381805164`"},
     {"40.07671495169784`", "59.923285048302155`"},
     {"53.93867263814669`", "46.06132736185331`"},
     {"54.227847654903286`", "45.77215234509672`"},
     {"54.218874036411925`", "45.78112596358807`"},
     {"40.61002926453859`", "59.389970735461404`"},
     {"51.61659637781351`", "48.383403622186485`"},
     {"48.41281675383017`", "51.58718324616983`"},
     {"53.969071017245106`", "46.030928982754894`"},
     {"50.13861098577662`", "49.861389014223384`"},
     {"51.10314645975428`", "48.89685354024572`"},
     {"47.98187957413334`", "52.01812042586666`"},
     {"48.504447674016156`", "51.49555232598385`"},
     {"43.552229010403764`", "56.447770989596236`"},
     {"54.57105776498713`", "45.42894223501287`"},
     {"42.69166775203096`", "57.30833224796904`"},
     {"52.72100037707078`", "47.27899962292922`"},
     {"43.77131332543496`", "56.22868667456504`"},
     {"45.63950353638759`", "54.36049646361241`"},
     {"43.66244815117118`", "56.3375518488288`"},
     {"54.36508772947861`", "45.63491227052138`"},
     {"52.873320531408254`", "47.12667946859176`"},
     {"53.46024134475902`", "46.53975865524097`"},
     {"46.15815957746862`", "53.841840422531384`"},
     {"51.40455992304658`", "48.595440076953416`"},
     {"51.10144381298927`", "48.89855618701073`"},
     {"49.88626301805148`", "50.113736981948534`"},
     {"45.23883616907783`", "54.761163830922165`"},
     {"54.27402885795362`", "45.72597114204639`"},
     {"52.07866688814876`", "47.92133311185125`"},
     {"51.424857723857556`", "48.57514227614246`"},
     {"48.65218076966759`", "51.34781923033241`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7106124279784403`*^9, 3.710612492188153*^9, 3.710664674379195*^9, 
   3.7106649925613937`*^9, 3.7106652268827963`*^9, {3.710668235301868*^9, 
   3.710668253761924*^9}},ExpressionUUID->"64bc4fa8-cfbf-4d37-9cd1-\
dc4ebd49e092"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"correct", "[", "a_", "]"}], "=", 
  RowBox[{"Boole", "[", 
   RowBox[{"a", ">", "0.5"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.710664707896112*^9, 
  3.710664753614727*^9}},ExpressionUUID->"101548da-8d3e-4b8b-a31f-\
4f8087dc999b"],

Cell[BoxData[
 RowBox[{"Boole", "[", 
  RowBox[{"a", ">", "0.5`"}], "]"}]], "Output",
 CellChangeTimes->{3.710664760103098*^9, 
  3.710668255249009*^9},ExpressionUUID->"3389e930-fac6-4a3d-bdbf-\
3ee436fe286c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"spred1b", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"correct", ",", "pred1b", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
  RowBox[{"spred2b", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"correct", ",", "pred2b", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.710664780484264*^9, 3.7106647840534678`*^9}, {
  3.7106648175243826`*^9, 3.7106648979559827`*^9}, {3.710664958672456*^9, 
  3.710664966008875*^9}, {3.710665004783093*^9, 3.7106650184778767`*^9}, {
  3.7106652325601215`*^9, 
  3.7106652368453665`*^9}},ExpressionUUID->"d8afa16b-6187-41d8-adbc-\
f0795f2fdb0f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Total", "[", "spred1b", "]"}], ",", 
   RowBox[{"Total", "[", "spred2b", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.7106650212810364`*^9, 3.710665033476734*^9}, {
  3.7106652408025923`*^9, 
  3.7106652421826715`*^9}},ExpressionUUID->"558a7744-3465-4102-8fbc-\
49158c4e642e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"37", ",", "19"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"25", ",", "23"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.710665033806753*^9, 3.710665242710702*^9, 
  3.7106682584031897`*^9},ExpressionUUID->"1a907f70-c027-4970-926e-\
96e0fd2a8569"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Mean", "[", "pred1b", "]"}], ",", 
   RowBox[{"Mean", "[", "pred2b", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.7106650440593395`*^9, 3.7106650575051084`*^9}, {
  3.710665247012948*^9, 
  3.7106652482000155`*^9}},ExpressionUUID->"c0355cd9-0d03-46fd-b75d-\
906a57705df0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.5073796015829947`", ",", "0.4926203984170054`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.49103428993616616`", ",", "0.5089657100638338`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7106650578541284`*^9, 3.7106652489470587`*^9, 
  3.7106682592982407`*^9},ExpressionUUID->"74987714-b6fb-404d-9c92-\
d2fa5a1e6446"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Total", "[", "spred1", "]"}], ",", 
   RowBox[{"Total", "[", "spred2", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.7106650212810364`*^9, 3.710665033476734*^9}, {
  3.7106652408025923`*^9, 
  3.710665263975918*^9}},ExpressionUUID->"1e9f6009-bbdf-4547-942f-\
9228bd28f479"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"37", ",", "19"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"26", ",", "22"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.710665033806753*^9, {3.710665242710702*^9, 3.7106652645969534`*^9}, 
   3.710668260052284*^9},ExpressionUUID->"f47e9402-fe9d-441f-8aeb-\
59c2d9d962f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Mean", "[", "pred1", "]"}], ",", 
   RowBox[{"Mean", "[", "pred2", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.7106650440593395`*^9, 3.7106650575051084`*^9}, {
  3.710665247012948*^9, 
  3.710665271607354*^9}},ExpressionUUID->"510e0c2b-d0c9-4657-8cfd-\
dee4176d4469"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.5973152238880388`", ",", "0.4026847761119612`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.48163317337349104`", ",", "0.518366826626509`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7106650578541284`*^9, {3.7106652489470587`*^9, 3.7106652720603805`*^9}, 
   3.7106682608293285`*^9},ExpressionUUID->"31865a7c-7bc9-408d-9dfb-\
79b5d4cbde6e"]
}, Open  ]]
},
WindowSize->{750, 755},
WindowMargins->{{52, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.1 for Microsoft Windows (32-bit) (March 13, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 491, 8, 33, "Input", "ExpressionUUID" -> \
"e74e1d84-53fd-438e-8f5f-79f66fc787a7"],
Cell[CellGroupData[{
Cell[1074, 32, 474, 9, 33, "Input", "ExpressionUUID" -> \
"1f8eeb65-a040-491e-a1eb-38c907b68f39"],
Cell[1551, 43, 467, 7, 30, "Output", "ExpressionUUID" -> \
"3e856546-6c11-4af1-ab97-e92c1270242b"]
}, Open  ]],
Cell[2033, 53, 8072, 211, 634, "Input", "ExpressionUUID" -> \
"c6aaa433-c6f9-4d1b-8454-e334098dee90"],
Cell[10108, 266, 2756, 70, 209, "Input", "ExpressionUUID" -> \
"2f02cc0d-748d-416f-a7fc-ff2a27984716"],
Cell[12867, 338, 295, 7, 50, "Input", "ExpressionUUID" -> \
"72477d72-72a1-4d79-9306-728b01167edf"],
Cell[CellGroupData[{
Cell[13187, 349, 557, 16, 33, "Input", "ExpressionUUID" -> \
"d5979a45-6609-4bc9-b629-2a0e641ccd40"],
Cell[13747, 367, 542, 16, 60, "Output", "ExpressionUUID" -> \
"96dfa114-edaa-45c1-8218-b85487756a9a"]
}, Open  ]],
Cell[14304, 386, 859, 24, 77, "Input", "ExpressionUUID" -> \
"527ec65d-51e7-4123-ba80-8da25ce6354f"],
Cell[15166, 412, 1958, 51, 162, "Input", "ExpressionUUID" -> \
"79a2b523-0028-42dc-86ea-e164b92d2a4b"],
Cell[17127, 465, 848, 25, 77, "Input", "ExpressionUUID" -> \
"8c48fab1-90da-4b07-baea-60a252fdf4ee"],
Cell[CellGroupData[{
Cell[18000, 494, 419, 11, 33, "Input", "ExpressionUUID" -> \
"b4b76bc4-37e4-4388-a8af-4d5df0f40c81"],
Cell[18422, 507, 276, 5, 30, "Output", "ExpressionUUID" -> \
"e946676c-f0e6-47e1-81f6-cce806b569b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18735, 517, 372, 10, 33, "Input", "ExpressionUUID" -> \
"83287d2d-6d5f-499f-9f09-aaa13f55365f"],
Cell[19110, 529, 220, 4, 30, "Output", "ExpressionUUID" -> \
"c696c4d2-8448-478b-abdc-844eb17d731b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19367, 538, 1171, 30, 99, "Input", "ExpressionUUID" -> \
"4b399ba8-f27c-407a-9d3f-0ea103923259"],
Cell[20541, 570, 3680, 76, 1090, "Output", "ExpressionUUID" -> \
"d53f3fa8-1783-448a-b526-d278583367bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24258, 651, 187, 4, 33, "Input", "ExpressionUUID" -> \
"b18c99a7-6590-43a5-b30f-0e1cf7937003"],
Cell[24448, 657, 311, 7, 30, "Output", "ExpressionUUID" -> \
"fff11976-3b05-4f8a-99e5-cc9577473855"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24796, 669, 1179, 30, 99, "Input", "ExpressionUUID" -> \
"a4cc623e-14f3-4063-baba-515afb3d0066"],
Cell[25978, 701, 3246, 67, 938, "Output", "ExpressionUUID" -> \
"8e94d3de-00ea-40e5-ace6-dc2eefd0faa4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29261, 773, 268, 7, 30, "Input", "ExpressionUUID" -> \
"4c689dc1-0a57-4de6-9a90-b0fed0fe6019"],
Cell[29532, 782, 235, 5, 30, "Output", "ExpressionUUID" -> \
"caaa9873-7023-48d5-902a-75b6aad7e161"]
}, Open  ]],
Cell[29782, 790, 592, 14, 33, "Input", "ExpressionUUID" -> \
"c867156b-671f-445d-a5c5-4a95fd72adff"],
Cell[CellGroupData[{
Cell[30399, 808, 276, 7, 33, "Input", "ExpressionUUID" -> \
"40a7d8a0-e7c1-49c5-b78c-820998d6c5a8"],
Cell[30678, 817, 325, 9, 30, "Output", "ExpressionUUID" -> \
"83f04dd2-fb9f-4a85-a09c-725eaaa0cf66"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31040, 831, 274, 7, 33, "Input", "ExpressionUUID" -> \
"762f020d-f465-4c3e-bdf4-6b4458709c82"],
Cell[31317, 840, 396, 10, 30, "Output", "ExpressionUUID" -> \
"2e60e6af-2a23-4bad-b79e-0d245bbc00a4"]
}, Open  ]],
Cell[31728, 853, 292, 7, 50, "Input", "ExpressionUUID" -> \
"a130a600-5850-4b13-9ef3-b87153ba7c7a"],
Cell[32023, 862, 8038, 204, 610, "Input", "ExpressionUUID" -> \
"3f417bb5-acba-454a-918a-e1abc0d16546"],
Cell[40064, 1068, 2756, 70, 209, "Input", "ExpressionUUID" -> \
"c6960225-1d53-4712-aecc-37c14d4c53e1"],
Cell[42823, 1140, 295, 7, 50, "Input", "ExpressionUUID" -> \
"24d4add2-e2f8-4116-ac83-5248f146d3ee"],
Cell[CellGroupData[{
Cell[43143, 1151, 557, 16, 33, "Input", "ExpressionUUID" -> \
"a859cf1b-b954-496b-aa4a-31bc80e6afaa"],
Cell[43703, 1169, 496, 16, 60, "Output", "ExpressionUUID" -> \
"81b4d6e7-114e-49a4-ad4e-007b89b3881f"]
}, Open  ]],
Cell[44214, 1188, 859, 24, 77, "Input", "ExpressionUUID" -> \
"d21ba48d-6945-4cb7-a651-1c125569fc1a"],
Cell[45076, 1214, 1958, 51, 162, "Input", "ExpressionUUID" -> \
"693ceafd-431c-4674-8a41-b0d1e97b8702"],
Cell[47037, 1267, 848, 25, 77, "Input", "ExpressionUUID" -> \
"406af074-a05c-4b63-8d98-d44f69294638"],
Cell[CellGroupData[{
Cell[47910, 1296, 419, 11, 33, "Input", "ExpressionUUID" -> \
"14f60fbc-cdf9-4a2e-b573-05c50077d170"],
Cell[48332, 1309, 300, 5, 30, "Output", "ExpressionUUID" -> \
"e15a964d-b491-4c91-9371-d04fc9616e24"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48669, 1319, 372, 10, 33, "Input", "ExpressionUUID" -> \
"792c0821-c245-430b-b67e-d92e75b36260"],
Cell[49044, 1331, 249, 5, 30, "Output", "ExpressionUUID" -> \
"1276a2b0-65fb-4628-9c92-e4df584f32a7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49330, 1341, 1202, 31, 99, "Input", "ExpressionUUID" -> \
"76ba5088-3c3c-4b1d-9bfb-69c6312bf56a"],
Cell[50535, 1374, 3706, 76, 1090, "Output", "ExpressionUUID" -> \
"91b72ff8-7ba6-4da0-86ab-95d89556a116"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54278, 1455, 211, 4, 33, "Input", "ExpressionUUID" -> \
"57341d84-dadc-4121-9171-6eb82d3d2321"],
Cell[54492, 1461, 366, 8, 30, "Output", "ExpressionUUID" -> \
"792c718f-cfe4-445a-8ecd-28142fd9d92f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54895, 1474, 1208, 31, 99, "Input", "ExpressionUUID" -> \
"41ba7e75-24d3-4c02-b40a-cfeccdecc51f"],
Cell[56106, 1507, 3272, 68, 938, "Output", "ExpressionUUID" -> \
"64bc4fa8-cfbf-4d37-9cd1-dc4ebd49e092"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59415, 1580, 268, 7, 30, "Input", "ExpressionUUID" -> \
"101548da-8d3e-4b8b-a31f-4f8087dc999b"],
Cell[59686, 1589, 209, 5, 30, "Output", "ExpressionUUID" -> \
"3389e930-fac6-4a3d-bdbf-3ee436fe286c"]
}, Open  ]],
Cell[59910, 1597, 649, 15, 55, "Input", "ExpressionUUID" -> \
"d8afa16b-6187-41d8-adbc-f0795f2fdb0f"],
Cell[CellGroupData[{
Cell[60584, 1616, 331, 8, 33, "Input", "ExpressionUUID" -> \
"558a7744-3465-4102-8fbc-49158c4e642e"],
Cell[60918, 1626, 323, 9, 30, "Output", "ExpressionUUID" -> \
"1a907f70-c027-4970-926e-96e0fd2a8569"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61278, 1640, 327, 8, 33, "Input", "ExpressionUUID" -> \
"c0355cd9-0d03-46fd-b75d-906a57705df0"],
Cell[61608, 1650, 399, 10, 30, "Output", "ExpressionUUID" -> \
"74987714-b6fb-404d-9c92-d2fa5a1e6446"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62044, 1665, 327, 8, 33, "Input", "ExpressionUUID" -> \
"1e9f6009-bbdf-4547-942f-9228bd28f479"],
Cell[62374, 1675, 351, 10, 30, "Output", "ExpressionUUID" -> \
"f47e9402-fe9d-441f-8aeb-59c2d9d962f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62762, 1690, 323, 8, 33, "Input", "ExpressionUUID" -> \
"510e0c2b-d0c9-4657-8cfd-dee4176d4469"],
Cell[63088, 1700, 428, 11, 30, "Output", "ExpressionUUID" -> \
"31865a7c-7bc9-408d-9dfb-79b5d4cbde6e"]
}, Open  ]]
}
]
*)

